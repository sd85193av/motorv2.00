

Microchip MPLAB XC8 Assembler V2.40 build 20220703182018 
                                                                                                           Mon Oct 02 16:38:53 2023


     1                           	processor	16F1947
     2                           	pagewidth 132
     3                           	psect	udata_shr,global,class=COMMON,space=1,delta=1,noexec
     4                           	psect	udata,global,class=RAM,space=1,delta=1,noexec
     5                           	psect	udata_bank0,global,class=BANK0,space=1,delta=1,noexec
     6                           	psect	udata_bank1,global,class=BANK1,space=1,delta=1,noexec
     7                           	psect	udata_bank2,global,class=BANK2,space=1,delta=1,noexec
     8                           	psect	udata_bank3,global,class=BANK3,space=1,delta=1,noexec
     9                           	psect	udata_bank4,global,class=BANK4,space=1,delta=1,noexec
    10                           	psect	udata_bank5,global,class=BANK5,space=1,delta=1,noexec
    11                           	psect	udata_bank6,global,class=BANK6,space=1,delta=1,noexec
    12                           	psect	udata_bank7,global,class=BANK7,space=1,delta=1,noexec
    13                           	psect	udata_bank8,global,class=BANK8,space=1,delta=1,noexec
    14                           	psect	udata_bank9,global,class=BANK9,space=1,delta=1,noexec
    15                           	psect	udata_bank10,global,class=BANK10,space=1,delta=1,noexec
    16                           	psect	udata_bank11,global,class=BANK11,space=1,delta=1,noexec
    17                           	psect	udata_bank12,global,class=BANK12,space=1,delta=1,noexec
    18                           	psect	code,global,class=CODE,delta=2
    19                           	psect	data,global,class=STRCODE,delta=2,noexec
    20                           	psect	edata,global,class=EEDATA,space=3,delta=2,noexec
    21                           	psect	main,global,size=2048,class=CODE,delta=2
    22                           	psect	config,global,abs,ovrld,class=CONFIG,space=4,delta=2,noexec
    23                           
    24                           ;========================================================
    25                           ;================ Project Information ===================
    26                           ;========================================================
    27                           ;Project Name : MOTOR-MODULE_V2.00
    28                           ;Project Version:
    29                           ;Project object :
    30                           ;Project number :
    31                           ;Edit Date :
    32                           ;--------------------------------------------------------
    33                           ;========================================================
    34                           ;========================================================
    35                           ;========================================================
    36                           ;========================================================
    37                           ;======== PIC16F1947 Configuration Bit Settings =========
    38                           ;========================================================
    39                           ; PIC16F1947 Configuration Bit Settings
    40                           ; Assembly source line config statements
    41                           ; CONFIG1
    42                           ; CONFIG2
    43                           ;** ***************************************************************************************
    44                           ;==========================================================================
    45                           ; MPASM PIC16LF1947 processor include
    46                           ;
    47                           ; (c) Copyright 1999-2013 Microchip Technology, All rights reserved
    48                           ;==========================================================================
    49                           ;==========================================================================
    50                           ; This header file defines configurations, registers, and other useful
    51                           ; bits of information for the PIC16LF1947 microcontroller. These names
    52                           ; are taken to match the data sheets as closely as possible.
    53                           ;
    54                           ; Note that the processor must be selected before this file is included.
    55                           ; The processor may be selected the following ways:
    56                           ;
    57                           ; 1. Command line switch:
    58                           ; C:\MPASM MYFILE.ASM /PIC16LF1947
    59                           ; 2. LIST directive in the source file
    60                           ; LIST P=PIC16LF1947
    61                           ; 3. Processor Type entry in the MPASM full-screen interface
    62                           ; 4. Setting the processor in the MPLAB Project Dialog
    63                           ;==========================================================================
    64                           ;==========================================================================
    65                           ;
    66                           ; Verify Processor
    67                           ;
    68                           ;==========================================================================
    69                           ; IFNDEF __16LF1947
    70                           ; MESSG "Processor-header file mismatch.  Verify selected processor."
    71                           ; ENDIF
    72                           ;==========================================================================
    73                           ;
    74                           ; Register Definitions
    75                           ;
    76                           ;==========================================================================
    77                           ;W EQU 0000H
    78                           ;F EQU 0001H
    79                           ;----- Register Files -----------------------------------------------------
    80                           ;-----Bank0------------------
    81     0003                     
    82                           ;FSR0 EQU 0004H
    83     0005                     
    84                           ;FSR1 EQU 0006H
    85     001F                     
    86                           ;-----Bank1------------------
    87     009E                     
    88                           ;-----Bank2------------------
    89     011F                     
    90                           ;-----Bank3------------------
    91     019F                     
    92                           ;-----Bank4------------------
    93     021F                     
    94                           ;-----Bank5------------------
    95     029F                     
    96                           ;-----Bank6------------------
    97     031E                     
    98                           ;-----Bank7------------------
    99     0396                     
   100                           ;-----Bank8------------------
   101     041E                     
   102                           ;-----Bank9------------------
   103     0497                     
   104                           ;-----Bank15------------------
   105     07B7                     
   106                           ;-----Bank31------------------
   107     0FEF                     
   108                           ;----- STATUS Bits -----------------------------------------------------
   109     0004                     
   110                           ;----- BSR Bits -----------------------------------------------------
   111     0004                     
   112                           ;----- INTCON Bits -----------------------------------------------------
   113     0005                     
   114                           ;----- PORTA Bits -----------------------------------------------------
   115     0007                     
   116                           ;----- PORTB Bits -----------------------------------------------------
   117     0000                     
   118                           ;----- PORTC Bits -----------------------------------------------------
   119     0002                     
   120                           ;----- PORTD Bits -----------------------------------------------------
   121     0006                     
   122                           ;----- PORTE Bits -----------------------------------------------------
   123     0007                     
   124                           ;----- PIR1 Bits -----------------------------------------------------
   125     0005                     
   126                           ;----- PIR2 Bits -----------------------------------------------------
   127     0007                     
   128                           ;----- PIR3 Bits -----------------------------------------------------
   129     0006                     
   130                           ;----- PIR4 Bits -----------------------------------------------------
   131     0005                     
   132                           ;----- T1CON Bits -----------------------------------------------------
   133     0007                     
   134                           ;----- T1GCON Bits -----------------------------------------------------
   135     0003                     
   136                           ;----- T2CON Bits -----------------------------------------------------
   137     0006                     
   138                           ;----- CPSCON0 Bits -----------------------------------------------------
   139     0007                     
   140                           ;----- CPSCON1 Bits -----------------------------------------------------
   141     0004                     
   142                           ;----- TRISA Bits -----------------------------------------------------
   143     0007                     
   144                           ;----- TRISB Bits -----------------------------------------------------
   145     0007                     
   146                           ;----- TRISC Bits -----------------------------------------------------
   147     0007                     
   148                           ;----- TRISD Bits -----------------------------------------------------
   149     0007                     
   150                           ;----- TRISE Bits -----------------------------------------------------
   151     0007                     
   152                           ;----- PIE1 Bits -----------------------------------------------------
   153     0005                     
   154                           ;----- PIE2 Bits -----------------------------------------------------
   155     0007                     
   156                           ;----- PIE3 Bits -----------------------------------------------------
   157     0006                     
   158                           ;----- PIE4 Bits -----------------------------------------------------
   159     0005                     
   160                           ;----- OPTION_REG Bits -----------------------------------------------------
   161     0005                     
   162                           ;----- PCON Bits -----------------------------------------------------
   163     0007                     
   164                           ;----- WDTCON Bits -----------------------------------------------------
   165     0005                     
   166                           ;----- OSCTUNE Bits -----------------------------------------------------
   167     0005                     
   168                           ;----- OSCCON Bits -----------------------------------------------------
   169     0007                     
   170                           ;----- OSCSTAT Bits -----------------------------------------------------
   171     0007                     
   172                           ;----- ADCON0 Bits -----------------------------------------------------
   173     0001                     
   174                           ;----- ADCON1 Bits -----------------------------------------------------
   175     0007                     
   176                           ;----- LATA Bits -----------------------------------------------------
   177     0007                     
   178                           ;----- LATB Bits -----------------------------------------------------
   179     0007                     
   180                           ;----- LATC Bits -----------------------------------------------------
   181     0007                     
   182                           ;----- LATD Bits -----------------------------------------------------
   183     0007                     
   184                           ;----- LATE Bits -----------------------------------------------------
   185     0007                     
   186                           ;----- CM1CON0 Bits -----------------------------------------------------
   187     0007                     
   188                           ;----- CM1CON1 Bits -----------------------------------------------------
   189     0007                     
   190                           ;----- CM2CON0 Bits -----------------------------------------------------
   191     0007                     
   192                           ;----- CM2CON1 Bits -----------------------------------------------------
   193     0007                     
   194                           ;----- CMOUT Bits -----------------------------------------------------
   195     0002                     
   196                           ;----- BORCON Bits -----------------------------------------------------
   197     0007                     
   198                           ;----- FVRCON Bits -----------------------------------------------------
   199     0007                     
   200                           ;----- DACCON0 Bits -----------------------------------------------------
   201     0007                     
   202                           ;----- DACCON1 Bits -----------------------------------------------------
   203     0004                     
   204                           ;----- SRCON0 Bits -----------------------------------------------------
   205     0007                     
   206                           ;----- SRCON1 Bits -----------------------------------------------------
   207     0007                     
   208                           ;----- APFCON Bits -----------------------------------------------------
   209     0007                     
   210                           ;----- CM3CON0 Bits -----------------------------------------------------
   211     0007                     
   212                           ;----- CM3CON1 Bits -----------------------------------------------------
   213     0007                     
   214                           ;----- ANSELA Bits -----------------------------------------------------
   215     0005                     
   216                           ;----- ANSELE Bits -----------------------------------------------------
   217     0002                     
   218                           ;----- EECON1 Bits -----------------------------------------------------
   219     0007                     
   220                           ;----- RC1STA Bits -----------------------------------------------------
   221     0007                     
   222                           ;----- RCSTA Bits -----------------------------------------------------
   223     0007                     
   224                           ;----- TX1STA Bits -----------------------------------------------------
   225     0007                     
   226                           ;----- TXSTA Bits -----------------------------------------------------
   227     0007                     
   228                           ;----- BAUD1CON Bits -----------------------------------------------------
   229     0007                     
   230                           ;----- WPUB Bits -----------------------------------------------------
   231     0007                     
   232                           ;----- SSP1STAT Bits -----------------------------------------------------
   233     0007                     
   234                           ;----- SSPSTAT Bits -----------------------------------------------------
   235     0007                     
   236                           ;----- SSP1CON1 Bits -----------------------------------------------------
   237     0007                     
   238                           ;----- SSPCON Bits -----------------------------------------------------
   239     0007                     
   240                           ;----- SSPCON1 Bits -----------------------------------------------------
   241     0007                     
   242                           ;----- SSP1CON2 Bits -----------------------------------------------------
   243     0007                     
   244                           ;----- SSPCON2 Bits -----------------------------------------------------
   245     0007                     
   246                           ;----- SSP1CON3 Bits -----------------------------------------------------
   247     0007                     
   248                           ;----- SSPCON3 Bits -----------------------------------------------------
   249     0007                     
   250                           ;----- SSP2STAT Bits -----------------------------------------------------
   251     0007                     
   252                           ;----- SSP2CON1 Bits -----------------------------------------------------
   253     0007                     
   254                           ;----- SSP2CON2 Bits -----------------------------------------------------
   255     0007                     
   256                           ;----- SSP2CON3 Bits -----------------------------------------------------
   257     0007                     
   258                           ;----- PORTF Bits -----------------------------------------------------
   259     0007                     
   260                           ;----- PORTG Bits -----------------------------------------------------
   261     0004                     
   262                           ;----- CCP1CON Bits -----------------------------------------------------
   263     0007                     
   264                           ;----- PWM1CON Bits -----------------------------------------------------
   265     0007                     
   266                           ;----- CCP1AS Bits -----------------------------------------------------
   267     0007                     
   268                           ;----- ECCP1AS Bits -----------------------------------------------------
   269     0007                     
   270                           ;----- PSTR1CON Bits -----------------------------------------------------
   271     0004                     
   272                           ;----- CCP2CON Bits -----------------------------------------------------
   273     0007                     
   274                           ;----- PWM2CON Bits -----------------------------------------------------
   275     0007                     
   276                           ;----- CCP2AS Bits -----------------------------------------------------
   277     0007                     
   278                           ;----- ECCP2AS Bits -----------------------------------------------------
   279     0007                     
   280                           ;----- PSTR2CON Bits -----------------------------------------------------
   281     0004                     
   282                           ;----- CCPTMRS0 Bits -----------------------------------------------------
   283     0007                     
   284                           ;----- CCPTMRS1 Bits -----------------------------------------------------
   285     0001                     
   286                           ;----- TRISF Bits -----------------------------------------------------
   287     0007                     
   288                           ;----- TRISG Bits -----------------------------------------------------
   289     0005                     
   290                           ;----- CCP3CON Bits -----------------------------------------------------
   291     0007                     
   292                           ;----- PWM3CON Bits -----------------------------------------------------
   293     0007                     
   294                           ;----- CCP3AS Bits -----------------------------------------------------
   295     0007                     
   296                           ;----- ECCP3AS Bits -----------------------------------------------------
   297     0007                     
   298                           ;----- PSTR3CON Bits -----------------------------------------------------
   299     0004                     
   300                           ;----- CCP4CON Bits -----------------------------------------------------
   301     0005                     
   302                           ;----- CCP5CON Bits -----------------------------------------------------
   303     0005                     
   304                           ;----- LATF Bits -----------------------------------------------------
   305     0007                     
   306                           ;----- LATG Bits -----------------------------------------------------
   307     0005                     
   308                           ;----- IOCBP Bits -----------------------------------------------------
   309     0007                     
   310                           ;----- IOCBN Bits -----------------------------------------------------
   311     0007                     
   312                           ;----- IOCBF Bits -----------------------------------------------------
   313     0007                     
   314                           ;----- ANSELF Bits -----------------------------------------------------
   315     0007                     
   316                           ;----- ANSELG Bits -----------------------------------------------------
   317     0004                     
   318                           ;----- T4CON Bits -----------------------------------------------------
   319     0006                     
   320                           ;----- T6CON Bits -----------------------------------------------------
   321     0006                     
   322                           ;----- WPUG Bits -----------------------------------------------------
   323     0005                     
   324                           ;----- RC2STA Bits -----------------------------------------------------
   325     0007                     
   326                           ;----- TX2STA Bits -----------------------------------------------------
   327     0007                     
   328                           ;----- BAUD2CON Bits -----------------------------------------------------
   329     0007                     
   330                           ;----- LCDCON Bits -----------------------------------------------------
   331     0007                     
   332                           ;----- LCDPS Bits -----------------------------------------------------
   333     0007                     
   334                           ;----- LCDREF Bits -----------------------------------------------------
   335     0007                     
   336                           ;----- LCDCST Bits -----------------------------------------------------
   337     0002                     
   338                           ;----- LCDRL Bits -----------------------------------------------------
   339     0007                     
   340                           ;----- LCDSE0 Bits -----------------------------------------------------
   341     0007                     
   342                           ;----- LCDSE1 Bits -----------------------------------------------------
   343     0007                     
   344                           ;----- LCDSE2 Bits -----------------------------------------------------
   345     0007                     
   346                           ;----- LCDSE3 Bits -----------------------------------------------------
   347     0007                     
   348                           ;----- LCDSE4 Bits -----------------------------------------------------
   349     0007                     
   350                           ;----- LCDSE5 Bits -----------------------------------------------------
   351     0005                     
   352                           ;----- LCDDATA0 Bits -----------------------------------------------------
   353     0007                     
   354                           ;----- LCDDATA1 Bits -----------------------------------------------------
   355     0007                     
   356                           ;----- LCDDATA2 Bits -----------------------------------------------------
   357     0007                     
   358                           ;----- LCDDATA3 Bits -----------------------------------------------------
   359     0007                     
   360                           ;----- LCDDATA4 Bits -----------------------------------------------------
   361     0007                     
   362                           ;----- LCDDATA5 Bits -----------------------------------------------------
   363     0007                     
   364                           ;----- LCDDATA6 Bits -----------------------------------------------------
   365     0007                     
   366                           ;----- LCDDATA7 Bits -----------------------------------------------------
   367     0007                     
   368                           ;----- LCDDATA8 Bits -----------------------------------------------------
   369     0007                     
   370                           ;----- LCDDATA9 Bits -----------------------------------------------------
   371     0007                     
   372                           ;----- LCDDATA10 Bits -----------------------------------------------------
   373     0007                     
   374                           ;----- LCDDATA11 Bits -----------------------------------------------------
   375     0007                     
   376                           ;----- LCDDATA12 Bits -----------------------------------------------------
   377     0007                     
   378                           ;----- LCDDATA13 Bits -----------------------------------------------------
   379     0007                     
   380                           ;----- LCDDATA14 Bits -----------------------------------------------------
   381     0005                     
   382                           ;----- LCDDATA15 Bits -----------------------------------------------------
   383     0007                     
   384                           ;----- LCDDATA16 Bits -----------------------------------------------------
   385     0007                     
   386                           ;----- LCDDATA17 Bits -----------------------------------------------------
   387     0005                     
   388                           ;----- LCDDATA18 Bits -----------------------------------------------------
   389     0007                     
   390                           ;----- LCDDATA19 Bits -----------------------------------------------------
   391     0007                     
   392                           ;----- LCDDATA20 Bits -----------------------------------------------------
   393     0005                     
   394                           ;----- LCDDATA21 Bits -----------------------------------------------------
   395     0007                     
   396                           ;----- LCDDATA22 Bits -----------------------------------------------------
   397     0007                     
   398                           ;----- LCDDATA23 Bits -----------------------------------------------------
   399     0005                     
   400                           ;----- STATUS_SHAD Bits -----------------------------------------------------
   401     0002                     
   402                           	psect	edata
   403                           
   404                           ;==========================================================================
   405                           ;
   406                           ; Configuration Bits
   407                           ;
   408                           ; NAME Address
   409                           ; CONFIG1 8007h
   410                           ; CONFIG2 8008h
   411                           ;
   412                           ;==========================================================================
   413                           ;========================================================
   414                           ;================ Project Information ===================
   415                           ;========================================================
   416                           ;Pin Assignment :
   417                           ;Project Name :
   418                           ;Project Version: V2.00 (Bate00)
   419                           ;Project object :
   420                           ;Project number :
   421                           ;Edit Date : 2023/04/18
   422                           ;--------------------------------------------------------
   423                           ;========================================================
   424                           ;========================================================
   425                           ;INCLUDE TITLE
   426                           ;========================================================
   427                           ;================ Project Information ===================
   428                           ;========================================================
   429                           ;Project Name : MODBUS RTU BASE
   430                           ;-------------------------------------------------------
   431                           ;Project Version: 2.00
   432                           ;Edit Date : 2023/09/28
   433                           ;Function Info :
   434                           ;-------------------------------------------------------
   435                           ;Description of Register Informatione (use FSR)
   436                           ;MODBUS_DAT_BUF_ADRL+0 : set output byte count ( min = 1 )
   437                           ;MODBUS_DAT_BUF_ADRL+1 : set input byte count ( min = 0 )
   438                           ;MODBUS_DAT_BUF_ADRL+2 : BSR temporary(把進入前的BANK存起來)
   439                           ;MODBUS_DAT_BUF_ADRL+3 : Data offset temporary
   440                           ;MODBUS_DAT_BUF_ADRL+4 : CRC counter
   441                           ;MODBUS_DAT_BUF_ADRL+5 : CRC HBYTE
   442                           ;MODBUS_DAT_BUF_ADRL+6 : CRC LBYTE
   443                           ;MODBUS_DAT_BUF_ADRL+7 : time out count
   444                           ;MODBUS_DAT_BUF_ADRL+8 : MODBUS_FLAG
   445                           ;MODBUS_DAT_BUF_ADRL+A~n : Output buffer serial addressing
   446                           ;-------------------------------------------------------
   447                           ;-------------------------------------------------------
   448                           ;-------------------------------------------------------
   449                           ;須被定義的部分
   450     0003                     
   451                           ;-------------------------------------------------------
   452     00B0                     
   453                           ;========================================================
   454                           ;========================================================
   455     0074                     
   456                           ;-------------------------------------------------------
   457     038C                     
   458                           ;-------------------------------------------------------
   459                           ;暫存器ONLY NUM(TIMER BASE TIME IS 1mS)
   460     0040                     
   461                           ;0X21 0X40-0X21 0X54 MOTOR1
   462                           ;0X21 0X55-0X21 0X69 MOTOR2
   463                           ;0X21 0X6A-0X21 0X7E MOTOR3
   464                           ;0X21 0X7F-0X21 0X93 MOTOR4
   465                           ;-------------------------------------------------------
   466                           ;--------------------------------------------------------
   467                           ;WATCH用的暫存器設定
   468     0006                     
   469                           ;--------------------------------------------------------
   470                           ;--------------------------------------------------------
   471                           ;mcu腳位定義
   472                           ;Pin assignment definition
   473     0003                     	;0->往光遮端方向 1->反方向
   474     0005                     	;0->表示電源沒有進入 1->表示有電源
   475     0002                     
   476                           ;--------------------------------------------------------
   477                           ;--------------------------------------------------------
   478                           ;========================================================
   479                           ;==================== 0X20 ~ 0X2F =======================
   480                           ;========================================================
   481                           ;Register definition
   482     002A                     	;用來計算MODBUS RTU
   483     002D                     	;整理UART TX傳送的資料數量
   484     002F                     
   485                           ;========================================================
   486                           ;==================== 0X30 ~ 0X3F =======================
   487                           ;========================================================
   488                           ;Register definition
   489                           ;--------------------------------------
   490     0000                     	;可以回傳資料FLAG
   491     0001                     	;可以動作FLAG
   492     0002                     	;RX資料有錯誤
   493     0003                     	;強制命令執行後SET
   494     0004                     	;表示INT地一次觸發啟動INT_TIMER功能
   495                           
   496                           ;--------------------------------------------------------
   497                           ;馬達1為轉向馬達(目前使用在注射泵)
   498     0001                     	;馬達1收到指令可以進行運作
   499     0002                     	;馬達1順時針
   500     0003                     	;馬達1逆時針
   501     0038                     
   502                           ;--------------------------------------------------------馬達參數設定
   503     0039                     	;在通訊判斷使用哪個馬達的情況下使用
   504     0003                     
   505                           ;--------------------------------------------------------
   506     0004                     	;CMD 0X83全部停止動作
   507                           
   508                           ;--------------------------------------------------------
   509     0000                     
   510                           ;0X3D 0X3E 0X3F
   511                           ;========================================================
   512                           ;==================== 0X40 ~ 0X4F =======================
   513                           ;========================================================
   514                           ;Register definition
   515     0040                     	;每次一個PWM就+1
   516     0041                     	;每次一個PWM就+1
   517     0045                     
   518                           ;-----------------------------------------------
   519     00A0                     
   520                           ;--------------------------------------------------------------
   521                           ;------------------------BANK7參數設定-------------------------
   522                           ;--------------------------------------------------------------
   523     00A9                     
   524                           	psect	main
   525     0000                     	org	0
   526     0000  2805               	goto	BOOTLOADER_LOOP
   527     0004                     	org	4
   528     0004  2806               	goto	INTERRUPT_SUB_AREA
   529     0005                     BOOTLOADER_LOOP:	
   530                           ;* ****************************************************************************************
   531                           ;* Label Start
   532                           ;*
   533                           ;========================================================
   534                           ;================== BOOTLOADER副程式 ====================
   535                           ;========================================================
   536                           
   537     0005  2AF7               	goto	SYSTEM_START_SETTING
   538     0006                     INTERRUPT_SUB_AREA:	
   539                           ;========================================================
   540                           ;================== 中斷副程式起始位址 ==================
   541                           ;========================================================
   542                           
   543     0006  3180               	pagesel	0
   544     0007  0020               	banksel	12
   545                           
   546                           ;--------------------------
   547     0008  1A94               	btfsc	20,5
   548     0009  281A               	goto	RC2IF_FUNCTION_LOOP	;硬體UART2收資料
   549                           
   550                           ;--------------------------
   551     000A  1891               	btfsc	17,1
   552     000B  281E               	goto	TMR2IF_FUNCTION_LOOP	;TIMER2基準為1mS
   553                           
   554                           ;--------------------------
   555     000C  188B               	btfsc	11,1
   556     000D  2887               	goto	INT_INTF_FUNCTION	;PWM INT
   557                           
   558                           ;-----------
   559     000E  180B               	btfsc	11,0
   560     000F  285F               	goto	IOC_INT_FUNCTION	;光遮斷器觸發
   561     0010  0009               	retfie
   562     0011                     MODBUS_ADR_FUNCTION:	
   563                           ;******************************************************************************
   564                           ;****************************TABLE表區域***************************************
   565                           ;========================================================
   566                           ;==================中斷UART2 FUNCTION====================
   567                           ;========================================================
   568                           
   569     0011  3000               	movlw	0
   570     0012  008A               	movwf	10
   571     0013  084A               	movf	74,w
   572     0014  000B               	brw
   573     0015  281A               	goto	MODBUS_ADR_00_FUNCTION
   574     0016  281A               	goto	MODBUS_ADR_01_FUNCTION
   575     0017  281A               	goto	MODBUS_ADR_02_FUNCTION
   576     0018  281A               	goto	MODBUS_ADR_03_FUNCTION
   577     0019  281A               	goto	MODBUS_ADR_04_FUNCTION
   578     001A                     MODBUS_ADR_00_FUNCTION:
   579     001A                     MODBUS_ADR_01_FUNCTION:
   580     001A                     MODBUS_ADR_02_FUNCTION:
   581     001A                     MODBUS_ADR_03_FUNCTION:
   582     001A                     MODBUS_ADR_04_FUNCTION:
   583     001A                     RC2IF_FUNCTION_LOOP:	
   584                           ;******************************************************************************
   585                           ;******************************************************************************
   586                           ;========================================================
   587                           ;==================中斷UART2 FUNCTION====================
   588                           ;========================================================
   589                           
   590     001A  3188               	pagesel	2048
   591     001B  
                 warning: (2090) fixup overflow storing 0xD1F in 2 bytes
                 251F               	call	MODBUS_INTPUT_FUNCTION	;將資料存在INDF1
   592     001C  3180               	pagesel	0
   593     001D  0009               	retfie
   594     001E                     TMR2IF_FUNCTION_LOOP:	
   595                           ;========================================================
   596                           ;==================中斷TIMER2 FUNCTION===================
   597                           ;========================================================
   598                           ;TIMER2 BASE IS 1mS
   599                           
   600     001E  1091               	bcf	17,1
   601                           
   602                           ;---------------------
   603     001F  1CBA               	btfss	58,1
   604     0020  2825               	goto	TMR2IF_FUNCTION_LV0
   605     0021  0848               	movf	72,w
   606     0022  1903               	btfsc	3,2
   607     0023  2058               	call	TEN_MS_FUNCTION_LOOP
   608     0024  03C8               	decf	72,f
   609     0025                     TMR2IF_FUNCTION_LV0:
   610     0025  1E30               	btfss	48,4
   611     0026  282B               	goto	TMR2IF_FUNC_LV1
   612                           
   613                           ;---------
   614     0027  0824               	movf	36,w
   615     0028  1903               	btfsc	3,2
   616     0029  2842               	goto	TIMER2_INT_LV1
   617     002A  03A4               	decf	36,f
   618     002B                     TMR2IF_FUNC_LV1:
   619                           
   620                           ;判斷是否MODBUS RTU TIMEOUT 要啟動
   621     002B  3020               	movlw	32
   622     002C  0087               	movwf	7
   623     002D  30B0               	movlw	176
   624     002E  0086               	movwf	6
   625     002F  3008               	movlw	8
   626     0030  0786               	addwf	6,f
   627     0031  1C01               	btfss	1,0
   628     0032  0009               	retfie
   629     0033  0020               	banksel	12
   630                           
   631                           ;-----------------------------------
   632     0034  0386               	decf	6,f
   633     0035  0801               	movf	1,w
   634     0036  1D03               	btfss	3,2
   635     0037  283E               	goto	RESET_MODBUS_TIMEOUT_FUNCTION
   636                           
   637                           ;-----------------------------------
   638     0038  0020               	banksel	12
   639     0039  0823               	movf	35,w
   640     003A  1903               	btfsc	3,2
   641     003B  288D               	goto	MODBUS_TIMEOUT_IS_FINISH_LOOP
   642                           
   643                           ;----------------------------------=
   644     003C  03A3               	decf	35,f
   645     003D  0009               	retfie
   646     003E                     RESET_MODBUS_TIMEOUT_FUNCTION:	
   647                           ;-------------------------------------------------------
   648                           
   649                           
   650                           ;表示還是持續有收到資料，TIME OUT 資料重製
   651     003E  0181               	clrf	1
   652     003F  3004               	movlw	4
   653     0040  00A3               	movwf	35
   654     0041  0009               	retfie
   655     0042                     TIMER2_INT_LV1:	
   656                           ;------------------------------------------------------
   657                           ;INT 時間
   658                           
   659     0042  3004               	movlw	4
   660     0043  00A4               	movwf	36
   661     0044  0AC1               	incf	65,f
   662     0045  1230               	bcf	48,4
   663     0046  108B               	bcf	11,1
   664     0047  160B               	bsf	11,4
   665     0048  1EB2               	btfss	50,5
   666     0049  0009               	retfie
   667     004A  3021               	movlw	33
   668     004B  0085               	movwf	5
   669     004C  3040               	movlw	64
   670     004D  0084               	movwf	4
   671     004E  3015               	movlw	21
   672     004F  0784               	addwf	4,f
   673     0050  3005               	movlw	5
   674     0051  0784               	addwf	4,f
   675     0052  3001               	movlw	1
   676     0053  0280               	subwf	0,f
   677     0054  0384               	decf	4,f
   678     0055  3000               	movlw	0
   679     0056  3B80               	subwfb	0,f
   680     0057  0009               	retfie
   681     0058                     TEN_MS_FUNCTION_LOOP:
   682     0058  3002               	movlw	2
   683     0059  00C8               	movwf	72
   684     005A  3001               	movlw	1
   685     005B  07C7               	addwf	71,f
   686     005C  3000               	movlw	0
   687     005D  3DC6               	addwfc	70,f
   688     005E  0008               	return
   689     005F                     IOC_INT_FUNCTION:	
   690                           ;========================================================
   691                           ;==================中斷IOC FUNCTION====================
   692                           ;========================================================
   693                           
   694     005F  100B               	bcf	11,0
   695     0060  0027               	banksel	918
   696     0061  1896               	btfsc	918,1
   697     0062  2066               	call	IOCBF1_INT_LOOP
   698                           
   699                           ;--------
   700     0063  1916               	btfsc	918,2
   701     0064  2069               	call	IOCBF2_INT_LOOP
   702     0065  0009               	retfie
   703     0066                     IOCBF1_INT_LOOP:	
   704                           ;----------------------------------------------------------
   705                           
   706     0066  1096               	bcf	918,1
   707     0067  0027               	banksel	918
   708     0068  0008               	return
   709     0069                     IOCBF2_INT_LOOP:
   710     0069  1116               	bcf	918,2
   711     006A  0020               	banksel	12
   712     006B  2872               	goto	IOCBF2_INT_EXIT
   713     006C                     IOCBF2_INT_LOOP_LV1:	
   714                           ;BANKSEL PORTF
   715                           ;BSF PORTF,0X05
   716                           ;BCF PORTF,0X05
   717                           ;BANKSEL PORTA
   718                           ; MOVF IOC_COUNTER_HBYTE,W
   719                           ; BTFSS STATUS,Z
   720                           ; GOTO IOCBF2_INT_LOOP_LV1
   721 ;;------
   722                           ; MOVLW 0XFF
   723                           ; ADDWF IOC_COUNTER_LBYTE,W
   724                           ; BTFSS STATUS,C
   725                           ; GOTO IOC_ROCK_FUNCTION
   726                           ;------------------------------------------
   727                           
   728     006C  0020               	banksel	12
   729     006D  0AC0               	incf	64,f
   730     006E  17F2               	bsf	114,7
   731                           
   732                           ;BTFSC FLAG3_BANK0,NOW_IS_LO_HI_STATUS
   733     006F  190D               	btfsc	13,2
   734     0070  2874               	goto	IOCB2_HI_TO_LO
   735     0071  287C               	goto	IOCB2_LO_TO_HI
   736     0072                     IOCBF2_INT_EXIT:
   737     0072  0027               	banksel	918
   738     0073  0008               	return
   739     0074                     IOCB2_HI_TO_LO:
   740     0074  0027               	banksel	917
   741     0075  1515               	bsf	917,2
   742     0076  1114               	bcf	916,2
   743     0077  0020               	banksel	12
   744     0078  103A               	bcf	58,0
   745     0079  01C6               	clrf	70
   746     007A  01C7               	clrf	71
   747     007B  2872               	goto	IOCBF2_INT_EXIT
   748     007C                     IOCB2_LO_TO_HI:
   749     007C  0027               	banksel	917
   750     007D  1115               	bcf	917,2
   751     007E  1514               	bsf	916,2
   752     007F  0020               	banksel	12
   753                           
   754                           ;BANKSEL PORTF
   755                           ;BSF PORTF,0X02
   756                           ;BCF PORTF,0X02
   757                           ;BANKSEL PORTA
   758     0080  143A               	bsf	58,0
   759     0081  01C6               	clrf	70
   760     0082  01C7               	clrf	71
   761     0083  2872               	goto	IOCBF2_INT_EXIT
   762     0084                     IOC_ROCK_FUNCTION:
   763     0084  01C6               	clrf	70
   764     0085  01C7               	clrf	71
   765     0086  2872               	goto	IOCBF2_INT_EXIT
   766     0087                     INT_INTF_FUNCTION:	
   767                           ;========================================================
   768                           ;==================中斷INT FUNCTION====================
   769                           ;========================================================
   770                           
   771     0087  108B               	bcf	11,1
   772     0088  1A30               	btfsc	48,4
   773     0089  0009               	retfie
   774     008A  1630               	bsf	48,4
   775     008B  120B               	bcf	11,4
   776     008C  0009               	retfie
   777     008D                     MODBUS_TIMEOUT_IS_FINISH_LOOP:	
   778                           ;========================================================
   779                           ;=============MODBUS TIMEOUT到要進行分析的動作===========
   780                           ;========================================================
   781                           ;表示TIMEOUT到了，可以進行分析的動作
   782                           
   783                           
   784                           ;BANKSEL PORTF
   785                           ;BSF PORTF,0X07
   786                           ;NOP
   787                           ;BCF PORTF,0X07
   788                           ;BANKSEL PORTA
   789     008D  3004               	movlw	4
   790     008E  00A3               	movwf	35
   791     008F  0029               	banksel	1173
   792     0090  1215               	bcf	1173,4	;要進行分析資料前，先把UART RX關閉確保資料不會錯誤
   793     0091  0020               	banksel	12
   794     0092  3020               	movlw	32	;20B0
   795     0093  0087               	movwf	7
   796     0094  30B0               	movlw	176
   797     0095  0086               	movwf	6
   798     0096  3008               	movlw	8	;MODBUS_FLAG
   799     0097  0786               	addwf	6,f
   800     0098  0181               	clrf	1
   801                           
   802                           ;----------------------------------------------------------
   803     0099  3020               	movlw	32
   804     009A  0087               	movwf	7
   805     009B  30B0               	movlw	176
   806     009C  0086               	movwf	6
   807     009D  3003               	movlw	3	;MODBUS的DATA OFFSET
   808     009E  0786               	addwf	6,f
   809     009F  0801               	movf	1,w
   810     00A0  00AA               	movwf	42	;得到這次MODBUS所有的資料數量
   811     00A1  00AF               	movwf	47
   812     00A2  00C9               	movwf	73
   813     00A3  3002               	movlw	2
   814     00A4  02AA               	subwf	42,f
   815     00A5  0181               	clrf	1
   816                           
   817                           ;----------------------------------------------------------
   818     00A6  28D8               	goto	CHECK_CRC16_IS_RIGHT
   819     00A7                     MODBUS_CRC16_CHECK_IS_OK:	
   820                           ;===================================================
   821                           ;============MODBUS的CRC16驗證正確==================
   822                           ;===================================================
   823                           
   824     00A7  0020               	banksel	12
   825     00A8  3020               	movlw	32
   826     00A9  0087               	movwf	7
   827     00AA  30B0               	movlw	176
   828     00AB  0086               	movwf	6
   829     00AC  300A               	movlw	10
   830     00AD  0786               	addwf	6,f
   831                           
   832                           ;----------------------------------------------------------
   833     00AE  0801               	movf	1,w
   834     00AF  0625               	xorwf	37,w
   835     00B0  1D03               	btfss	3,2
   836     00B1  28CB               	goto	MODBUS_BUS_ID_ERROR_LOOP
   837                           
   838                           ;----------------------------------------------------------表示DEVICE ID 不對
   839     00B2  3008               	movlw	8
   840     00B3  062F               	xorwf	47,w
   841     00B4  1D03               	btfss	3,2
   842     00B5  28CB               	goto	MODBUS_BUS_ID_ERROR_LOOP	;當今天收到的資料數量大於8表示異常
   843                           
   844                           ;---------------
   845     00B6  0A86               	incf	6,f	;資料為功能碼
   846     00B7  3003               	movlw	3
   847     00B8  0601               	xorwf	1,w
   848     00B9  1903               	btfsc	3,2
   849     00BA  28F3               	goto	ANAY_MODBUS_CMD_03_LOOP	;功能碼是READ ONE BYTE
   850                           
   851                           ;---------------
   852     00BB  3006               	movlw	6
   853     00BC  0601               	xorwf	1,w
   854     00BD  1903               	btfsc	3,2
   855     00BE  29BD               	goto	ANAY_MODBUS_CMD_06_LOOP	;功能碼是WRITE ONE BYTE
   856     00BF                     MODBUS_BUS_01_ERROR_LOOP:	
   857                           ;目前功能碼只有接0X03 0X06，其他的算是ERROR
   858                           ;===================================================
   859                           ;============MODBUS的功能碼錯誤=====================
   860                           ;===================================================
   861                           ;MODBUS RTU ERROR CODE 01
   862                           
   863     00BF  143B               	bsf	59,0
   864     00C0  0009               	retfie
   865     00C1                     MODBUS_BUS_02_ERROR_LOOP:	
   866                           ;----------------------------------------
   867                           ;MODBUS RTU ERROR CODE 02
   868                           
   869     00C1  14BB               	bsf	59,1
   870     00C2  0009               	retfie
   871     00C3                     MODBUS_BUS_03_ERROR_LOOP:	
   872                           ;----------------------------------------
   873                           ;MODBUS RTU ERROR CODE 03
   874                           
   875     00C3  153B               	bsf	59,2
   876     00C4  0009               	retfie
   877     00C5                     MODBUS_BUS_04_ERROR_LOOP:	
   878                           ;----------------------------------------
   879                           ;MODBUS RTU ERROR CODE 04
   880                           
   881     00C5  15BB               	bsf	59,3
   882     00C6  0009               	retfie
   883     00C7                     MODBUS_BUS_05_ERROR_LOOP:	
   884                           ;----------------------------------------
   885                           ;MODBUS RTU ERROR CODE 05
   886                           
   887     00C7  163B               	bsf	59,4
   888     00C8  0009               	retfie
   889     00C9                     MODBUS_BUS_06_ERROR_LOOP:	
   890                           ;----------------------------------------
   891                           ;MODBUS RTU ERROR CODE 06
   892                           
   893     00C9  16BB               	bsf	59,5
   894     00CA  0009               	retfie
   895     00CB                     MODBUS_BUS_ID_ERROR_LOOP:	
   896                           ;----------------------------------------
   897                           ;===================================================
   898                           ;============MODBUS的ID或是資料數錯誤===============
   899                           ;===================================================
   900                           
   901     00CB  3020               	movlw	32
   902     00CC  0087               	movwf	7
   903     00CD  30B0               	movlw	176
   904     00CE  0086               	movwf	6
   905     00CF  300A               	movlw	10
   906     00D0  0786               	addwf	6,f
   907     00D1                     MODBUS_BUS_ID_ERROR_LV1:
   908     00D1  0181               	clrf	1
   909     00D2  0A86               	incf	6,f
   910     00D3  0BC9               	decfsz	73,f
   911     00D4  28D1               	goto	MODBUS_BUS_ID_ERROR_LV1
   912     00D5  0029               	banksel	1173
   913     00D6  1615               	bsf	1173,4
   914     00D7  0009               	retfie
   915     00D8                     CHECK_CRC16_IS_RIGHT:	
   916                           ;===================================================
   917                           ;================驗證CRC16是否正確?=================
   918                           ;===================================================
   919                           
   920     00D8  0020               	banksel	12
   921     00D9  30FF               	movlw	255
   922     00DA  00A8               	movwf	40
   923     00DB  30FF               	movlw	255
   924     00DC  00A9               	movwf	41
   925     00DD  3020               	movlw	32
   926     00DE  0087               	movwf	7
   927     00DF  30B0               	movlw	176
   928     00E0  0086               	movwf	6
   929     00E1  300A               	movlw	10
   930     00E2  0786               	addwf	6,f	;這裡是第一筆資料的位置
   931     00E3                     CHECK_CRC16_IS_RIGHT_LV1:
   932     00E3  0801               	movf	1,w
   933     00E4  00A7               	movwf	39
   934     00E5  270D               	call	CRC_16_FUNCTION_LOOP
   935     00E6  0A86               	incf	6,f
   936     00E7  0BAA               	decfsz	42,f
   937     00E8  28E3               	goto	CHECK_CRC16_IS_RIGHT_LV1
   938                           
   939                           ;----------------------------
   940     00E9  0829               	movf	41,w
   941     00EA  0601               	xorwf	1,w
   942     00EB  1D03               	btfss	3,2
   943     00EC  28CB               	goto	MODBUS_BUS_ID_ERROR_LOOP	;CRC16錯誤，模組不做回應
   944                           
   945                           ;----------------------------
   946     00ED  0A86               	incf	6,f
   947     00EE  0828               	movf	40,w
   948     00EF  0601               	xorwf	1,w
   949     00F0  1D03               	btfss	3,2
   950     00F1  28CB               	goto	MODBUS_BUS_ID_ERROR_LOOP	;CRC16錯誤，模組不做回應
   951     00F2  28A7               	goto	MODBUS_CRC16_CHECK_IS_OK	;CRC16驗證正確
   952     00F3                     ANAY_MODBUS_CMD_03_LOOP:	
   953                           ;========================================================
   954                           ;=============MODBUS 功能碼為0X03========================
   955                           ;========================================================
   956                           ;功能碼:0X03表示要READ
   957                           
   958     00F3  3020               	movlw	32
   959     00F4  0087               	movwf	7
   960     00F5  30B0               	movlw	176
   961     00F6  0086               	movwf	6
   962     00F7  300A               	movlw	10
   963     00F8  0786               	addwf	6,f	;這裡是第一筆資料的位置
   964     00F9  3005               	movlw	5
   965     00FA  0786               	addwf	6,f	;要讀取的WORD數
   966                           
   967                           ;-------------------
   968     00FB  0801               	movf	1,w
   969                           
   970                           ;MOVWF RTU_COUNTER_DATA ;要讀取的資料WORD數
   971     00FC  00AC               	movwf	44
   972     00FD  3020               	movlw	32
   973     00FE  0087               	movwf	7
   974     00FF  30B0               	movlw	176
   975     0100  0086               	movwf	6
   976     0101  300A               	movlw	10
   977     0102  0786               	addwf	6,f	;這裡是第一筆資料的位置
   978     0103  3003               	movlw	3
   979     0104  0786               	addwf	6,f
   980                           
   981                           ;-------------------------------
   982     0105  3070               	movlw	112
   983     0106  0701               	addwf	1,w
   984     0107  1803               	btfsc	3,0
   985     0108  2953               	goto	ANAY_MODBUS_READ_0X90_LOOP
   986     0109  3080               	movlw	128
   987     010A  0701               	addwf	1,w
   988     010B  1803               	btfsc	3,0
   989     010C  295E               	goto	ANAY_MODBUS_READ_0X80_LOOP	;表示使用的CMD是共用型
   990                           
   991                           ;-----------------------------------------------
   992     010D  3020               	movlw	32
   993     010E  0087               	movwf	7
   994     010F  30B0               	movlw	176
   995     0110  0086               	movwf	6
   996     0111  300A               	movlw	10
   997     0112  0786               	addwf	6,f	;這裡是第一筆資料的位置
   998     0113  3005               	movlw	5
   999     0114  0786               	addwf	6,f	;要讀取的WORD數
  1000     0115  3002               	movlw	2
  1001     0116  0286               	subwf	6,f	;判斷要讀取的ADR
  1002                           
  1003                           ;------------------
  1004     0117  0801               	movf	1,w
  1005     0118  00AB               	movwf	43
  1006     0119  00AE               	movwf	46
  1007     011A  30F0               	movlw	240
  1008     011B  05AB               	andwf	43,f
  1009                           
  1010                           ;-----------------
  1011     011C  3010               	movlw	16
  1012     011D  062B               	xorwf	43,w
  1013     011E  1903               	btfsc	3,2
  1014     011F  2990               	goto	READ_MOTOR_1_SOME_DATA
  1015                           
  1016                           ;-------------------
  1017     0120  3020               	movlw	32
  1018     0121  062B               	xorwf	43,w
  1019     0122  1903               	btfsc	3,2
  1020     0123  2995               	goto	READ_MOTOR_2_SOME_DATA
  1021                           
  1022                           ;-------------------
  1023     0124  3030               	movlw	48
  1024     0125  062B               	xorwf	43,w
  1025     0126  1903               	btfsc	3,2
  1026     0127  299C               	goto	READ_MOTOR_3_SOME_DATA
  1027                           
  1028                           ;-------------------
  1029     0128  3040               	movlw	64
  1030     0129  062B               	xorwf	43,w
  1031     012A  1903               	btfsc	3,2
  1032     012B  29A3               	goto	READ_MOTOR_4_SOME_DATA
  1033                           
  1034                           ;-------------------
  1035     012C  28BF               	goto	MODBUS_BUS_01_ERROR_LOOP
  1036     012D                     ANAY_MODBUS_CMD_03_LEVEL1:
  1037     012D  300F               	movlw	15
  1038     012E  05AE               	andwf	46,f
  1039                           
  1040                           ; MOVF ADR_TEST_TEMP,W
  1041                           ; ADDWF FSR0L,F
  1042     012F  1003               	bcf	3,0
  1043     0130  0DAE               	rlf	46,f
  1044     0131  082E               	movf	46,w
  1045     0132  0784               	addwf	4,f
  1046     0133  1003               	bcf	3,0
  1047     0134  0DAC               	rlf	44,f
  1048     0135  082C               	movf	44,w
  1049     0136  00AA               	movwf	42	;要讀的BYTE數
  1050                           
  1051                           ;------------------
  1052     0137  3020               	movlw	32
  1053     0138  0087               	movwf	7
  1054     0139  30B0               	movlw	176
  1055     013A  0086               	movwf	6
  1056     013B  300A               	movlw	10
  1057     013C  0786               	addwf	6,f	;這裡是第一筆資料的位置
  1058     013D  3002               	movlw	2
  1059     013E  0786               	addwf	6,f
  1060     013F  082A               	movf	42,w
  1061     0140  0081               	movwf	1
  1062     0141  0A86               	incf	6,f
  1063     0142                     ANAY_MODBUS_CMD_03_LEVEL2:	
  1064                           ;--------
  1065                           
  1066     0142  0800               	movf	0,w
  1067     0143  0081               	movwf	1
  1068                           
  1069                           ;MOVWF 0X71
  1070                           ;CALL AAAA_1800
  1071     0144  0A86               	incf	6,f
  1072     0145  0A84               	incf	4,f
  1073     0146  0BAC               	decfsz	44,f
  1074     0147  2942               	goto	ANAY_MODBUS_CMD_03_LEVEL2
  1075     0148  082A               	movf	42,w
  1076     0149  00AC               	movwf	44
  1077     014A  3003               	movlw	3
  1078     014B  07AA               	addwf	42,f
  1079                           
  1080                           ;----------------------------------------------------------
  1081     014C  22E0               	call	MODBUS_RTU_READ_LV2
  1082     014D  082C               	movf	44,w
  1083     014E  00AD               	movwf	45
  1084     014F  3005               	movlw	5
  1085     0150  07AD               	addwf	45,f
  1086     0151  1430               	bsf	48,0
  1087     0152  0009               	retfie
  1088     0153                     ANAY_MODBUS_READ_0X90_LOOP:	
  1089                           ;----------------------------------------------------------
  1090                           
  1091     0153  3020               	movlw	32
  1092     0154  0087               	movwf	7
  1093     0155  30B0               	movlw	176
  1094     0156  0086               	movwf	6
  1095     0157  300A               	movlw	10
  1096     0158  0786               	addwf	6,f	;這裡是第一筆資料的位置
  1097     0159  3003               	movlw	3
  1098     015A  0786               	addwf	6,f
  1099     015B  3080               	movlw	128
  1100     015C  0281               	subwf	1,f
  1101     015D  296A               	goto	ANAY_MODBUS_READ_LV0
  1102     015E                     ANAY_MODBUS_READ_0X80_LOOP:	
  1103                           ;----------------------------------------------------------
  1104                           
  1105     015E  3020               	movlw	32
  1106     015F  0087               	movwf	7
  1107     0160  30B0               	movlw	176
  1108     0161  0086               	movwf	6
  1109     0162  300A               	movlw	10
  1110     0163  0786               	addwf	6,f	;這裡是第一筆資料的位置
  1111     0164  3003               	movlw	3
  1112     0165  0786               	addwf	6,f
  1113     0166  3080               	movlw	128
  1114     0167  0281               	subwf	1,f
  1115     0168  1003               	bcf	3,0
  1116     0169  0D81               	rlf	1,f
  1117     016A                     ANAY_MODBUS_READ_LV0:
  1118                           
  1119                           ;-----------------------------------
  1120     016A  3022               	movlw	34
  1121     016B  0085               	movwf	5
  1122     016C  3030               	movlw	48
  1123     016D  0084               	movwf	4
  1124     016E  0801               	movf	1,w
  1125     016F  0784               	addwf	4,f
  1126                           
  1127                           ;-------------
  1128     0170  1003               	bcf	3,0
  1129     0171  0DAC               	rlf	44,f
  1130     0172  082C               	movf	44,w
  1131     0173  00AA               	movwf	42	;要讀的BYTE數
  1132                           
  1133                           ;------------------
  1134     0174  3020               	movlw	32
  1135     0175  0087               	movwf	7
  1136     0176  30B0               	movlw	176
  1137     0177  0086               	movwf	6
  1138     0178  300A               	movlw	10
  1139     0179  0786               	addwf	6,f	;這裡是第一筆資料的位置
  1140     017A  3002               	movlw	2
  1141     017B  0786               	addwf	6,f
  1142     017C  082A               	movf	42,w
  1143     017D  0081               	movwf	1
  1144     017E  0A86               	incf	6,f
  1145     017F                     ANAY_MODBUS_READ_0X80_LV1:	
  1146                           ;-----------------------------------
  1147                           
  1148     017F  0800               	movf	0,w
  1149     0180  0081               	movwf	1
  1150     0181  0A84               	incf	4,f
  1151     0182  0A86               	incf	6,f
  1152     0183  0BAC               	decfsz	44,f
  1153     0184  297F               	goto	ANAY_MODBUS_READ_0X80_LV1
  1154     0185  082A               	movf	42,w
  1155     0186  00AC               	movwf	44
  1156     0187  3003               	movlw	3
  1157     0188  07AA               	addwf	42,f
  1158                           
  1159                           ;----------------------------------------------------------
  1160     0189  22E0               	call	MODBUS_RTU_READ_LV2
  1161     018A  082C               	movf	44,w
  1162     018B  00AD               	movwf	45
  1163     018C  3005               	movlw	5
  1164     018D  07AD               	addwf	45,f
  1165     018E  1430               	bsf	48,0
  1166     018F  0009               	retfie
  1167     0190                     READ_MOTOR_1_SOME_DATA:	
  1168                           ;----------------------------------------------------------
  1169                           ;----------------------------------------------------------
  1170                           
  1171     0190  3021               	movlw	33
  1172     0191  0085               	movwf	5
  1173     0192  3040               	movlw	64
  1174     0193  0084               	movwf	4
  1175     0194  292D               	goto	ANAY_MODBUS_CMD_03_LEVEL1
  1176     0195                     READ_MOTOR_2_SOME_DATA:
  1177     0195  3021               	movlw	33
  1178     0196  0085               	movwf	5
  1179     0197  3040               	movlw	64
  1180     0198  0084               	movwf	4
  1181     0199  3015               	movlw	21
  1182     019A  0784               	addwf	4,f
  1183     019B  292D               	goto	ANAY_MODBUS_CMD_03_LEVEL1
  1184     019C                     READ_MOTOR_3_SOME_DATA:
  1185     019C  3021               	movlw	33
  1186     019D  0085               	movwf	5
  1187     019E  3040               	movlw	64
  1188     019F  0084               	movwf	4
  1189     01A0  302A               	movlw	42
  1190     01A1  0784               	addwf	4,f
  1191     01A2  292D               	goto	ANAY_MODBUS_CMD_03_LEVEL1
  1192     01A3                     READ_MOTOR_4_SOME_DATA:
  1193     01A3  3021               	movlw	33
  1194     01A4  0085               	movwf	5
  1195     01A5  3040               	movlw	64
  1196     01A6  0084               	movwf	4
  1197     01A7  303F               	movlw	63
  1198     01A8  0784               	addwf	4,f
  1199     01A9  292D               	goto	ANAY_MODBUS_CMD_03_LEVEL1
  1200     01AA                     STORE_WRITE_ACK_LOOP:
  1201     01AA  3020               	movlw	32
  1202     01AB  0085               	movwf	5
  1203     01AC  30B0               	movlw	176
  1204     01AD  0084               	movwf	4
  1205     01AE  300A               	movlw	10
  1206     01AF  0784               	addwf	4,f	;這裡是第一筆資料的位置
  1207                           
  1208                           ;-------------
  1209     01B0  3022               	movlw	34
  1210     01B1  0087               	movwf	7
  1211     01B2  3040               	movlw	64
  1212     01B3  0086               	movwf	6	;ADR_90_DAT00的位置
  1213     01B4  3008               	movlw	8
  1214     01B5  00F4               	movwf	116
  1215     01B6                     STORE_WRITE_ACK_LV1:	
  1216                           ;-------------
  1217                           
  1218     01B6  0800               	movf	0,w
  1219     01B7  0081               	movwf	1
  1220     01B8  0A84               	incf	4,f
  1221     01B9  0A86               	incf	6,f
  1222     01BA  0BF4               	decfsz	116,f
  1223     01BB  29B6               	goto	STORE_WRITE_ACK_LV1
  1224     01BC  0008               	return
  1225     01BD                     ANAY_MODBUS_CMD_06_LOOP:	
  1226                           ;========================================================
  1227                           ;=============MODBUS 功能碼為0X06========================
  1228                           ;========================================================
  1229                           
  1230     01BD  0020               	banksel	12
  1231     01BE  21AA               	call	STORE_WRITE_ACK_LOOP
  1232     01BF  3020               	movlw	32
  1233     01C0  0087               	movwf	7
  1234     01C1  30B0               	movlw	176
  1235     01C2  0086               	movwf	6
  1236     01C3  300A               	movlw	10
  1237     01C4  0786               	addwf	6,f	;這裡是第一筆資料的位置
  1238     01C5  3003               	movlw	3
  1239     01C6  0786               	addwf	6,f
  1240     01C7  3080               	movlw	128
  1241     01C8  0701               	addwf	1,w
  1242     01C9  1803               	btfsc	3,0
  1243     01CA  2A1A               	goto	ANAY_MODBUS_WRITE_0X80_LOOP	;表示使用的CMD是共用型
  1244     01CB  3020               	movlw	32
  1245     01CC  0087               	movwf	7
  1246     01CD  30B0               	movlw	176
  1247     01CE  0086               	movwf	6
  1248     01CF  300A               	movlw	10
  1249     01D0  0786               	addwf	6,f	;這裡是第一筆資料的位置
  1250     01D1  3003               	movlw	3
  1251     01D2  0786               	addwf	6,f
  1252                           
  1253                           ;-------------------
  1254                           ;-------------------
  1255     01D3  0801               	movf	1,w
  1256     01D4  00AB               	movwf	43
  1257     01D5  00AC               	movwf	44
  1258     01D6  00AE               	movwf	46
  1259     01D7  30F0               	movlw	240
  1260     01D8  05AB               	andwf	43,f
  1261                           
  1262                           ;------------
  1263     01D9  300F               	movlw	15
  1264     01DA  05AC               	andwf	44,f
  1265                           
  1266                           ;-----------------
  1267     01DB  3010               	movlw	16
  1268     01DC  062B               	xorwf	43,w
  1269     01DD  1903               	btfsc	3,2
  1270     01DE  2AC2               	goto	WRITE_MOTOR_1_SOME_DATA
  1271                           
  1272                           ;-------------------
  1273     01DF  3020               	movlw	32
  1274     01E0  062B               	xorwf	43,w
  1275     01E1  1903               	btfsc	3,2
  1276     01E2  2AC8               	goto	WRITE_MOTOR_2_SOME_DATA
  1277                           
  1278                           ;-------------------
  1279     01E3  3030               	movlw	48
  1280     01E4  062B               	xorwf	43,w
  1281     01E5  1903               	btfsc	3,2
  1282     01E6  2AD0               	goto	WRITE_MOTOR_3_SOME_DATA
  1283                           
  1284                           ;-------------------
  1285     01E7  3040               	movlw	64
  1286     01E8  062B               	xorwf	43,w
  1287     01E9  1903               	btfsc	3,2
  1288     01EA  2AD8               	goto	WRITE_MOTOR_4_SOME_DATA
  1289                           
  1290                           ;-------------------
  1291     01EB  28BF               	goto	MODBUS_BUS_01_ERROR_LOOP
  1292     01EC                     ANAY_MODBUS_CMD_06_LEVEL1:
  1293                           
  1294                           ;MOVF CAL_TEMP_LBYTE,W
  1295     01EC  1003               	bcf	3,0
  1296     01ED  0DAC               	rlf	44,f
  1297     01EE  082C               	movf	44,w
  1298     01EF  0784               	addwf	4,f
  1299                           
  1300                           ;--------------------------------------
  1301     01F0  3020               	movlw	32
  1302     01F1  0087               	movwf	7
  1303     01F2  30B0               	movlw	176
  1304     01F3  0086               	movwf	6
  1305     01F4  300A               	movlw	10
  1306     01F5  0786               	addwf	6,f	;這裡是第一筆資料的位置
  1307     01F6  3004               	movlw	4
  1308     01F7  0786               	addwf	6,f
  1309     01F8  0801               	movf	1,w
  1310     01F9  0080               	movwf	0
  1311     01FA  0A86               	incf	6,f
  1312     01FB  0A84               	incf	4,f
  1313     01FC  0801               	movf	1,w
  1314     01FD  0080               	movwf	0
  1315                           
  1316                           ;--------------------------------------
  1317     01FE  3008               	movlw	8
  1318     01FF  00AD               	movwf	45
  1319     0200  1430               	bsf	48,0
  1320     0201  082E               	movf	46,w
  1321     0202  00AC               	movwf	44
  1322     0203  300F               	movlw	15
  1323     0204  05AC               	andwf	44,f
  1324                           
  1325                           ;------------------------------------------------
  1326     0205  3009               	movlw	9
  1327     0206  062C               	xorwf	44,w
  1328     0207  1903               	btfsc	3,2
  1329     0208  2A9F               	goto	STRONG_STOP_FUNCTION
  1330                           
  1331                           ;------------------------
  1332     0209  3000               	movlw	0
  1333     020A  062C               	xorwf	44,w
  1334     020B  1903               	btfsc	3,2
  1335     020C  2A7F               	goto	CW_STEP_FUNCTION
  1336                           
  1337                           ;------------------------
  1338     020D  3001               	movlw	1
  1339     020E  062C               	xorwf	44,w
  1340     020F  1903               	btfsc	3,2
  1341     0210  2A8F               	goto	CCW_STEP_FUNCTION
  1342                           
  1343                           ;------------------------
  1344     0211  3004               	movlw	4
  1345     0212  062C               	xorwf	44,w
  1346     0213  1903               	btfsc	3,2
  1347     0214  2A73               	goto	RESET_STEP_FUNCTION
  1348     0215                     ANAY_MODBUS_CMD_06_EXIT:	
  1349                           ;------------------------------------------------
  1350                           
  1351     0215  1039               	bcf	57,0
  1352     0216  10B9               	bcf	57,1
  1353     0217  1139               	bcf	57,2
  1354     0218  11B9               	bcf	57,3
  1355     0219  0009               	retfie
  1356     021A                     ANAY_MODBUS_WRITE_0X80_LOOP:	
  1357                           ;-------------------------------------------
  1358                           ;-------------0X80以上的WRITE CMD-----------
  1359                           ;-------------------------------------------
  1360                           
  1361     021A  3008               	movlw	8
  1362     021B  00AD               	movwf	45
  1363     021C  1430               	bsf	48,0
  1364     021D  3083               	movlw	131
  1365     021E  0601               	xorwf	1,w
  1366     021F  1903               	btfsc	3,2
  1367     0220  2222               	call	COMMON_CMD_0X83_LOOP
  1368     0221  2A15               	goto	ANAY_MODBUS_CMD_06_EXIT
  1369     0222                     COMMON_CMD_0X83_LOOP:
  1370     0222  0A86               	incf	6,f
  1371     0223  0A86               	incf	6,f
  1372     0224  0801               	movf	1,w
  1373     0225  1903               	btfsc	3,2
  1374     0226  2A6A               	goto	RECOVER_MODULE_LOOP
  1375     0227  0027               	banksel	908
  1376     0228  3002               	movlw	2
  1377     0229  00A7               	movwf	167
  1378     022A  3002               	movlw	2
  1379     022B  00A3               	movwf	163
  1380     022C                     RECOVER_MODULE_LOOP_LV1:
  1381     022C  0022               	banksel	270
  1382     022D  100E               	bcf	270,0
  1383     022E  110E               	bcf	270,2
  1384     022F  0020               	banksel	12
  1385     0230  163A               	bsf	58,4
  1386     0231  1232               	bcf	50,4
  1387     0232  1272               	bcf	114,4
  1388     0233  1372               	bcf	114,6
  1389     0234  12F2               	bcf	114,5
  1390     0235  10B0               	bcf	48,1
  1391     0236  10B2               	bcf	50,1
  1392     0237  1036               	bcf	54,0
  1393     0238  10B6               	bcf	54,1
  1394     0239  10BA               	bcf	58,1
  1395     023A  10B5               	bcf	53,1
  1396     023B  1035               	bcf	53,0
  1397     023C  10F2               	bcf	114,1
  1398     023D  3021               	movlw	33
  1399     023E  0085               	movwf	5
  1400     023F  3040               	movlw	64
  1401     0240  0084               	movwf	4
  1402     0241  3007               	movlw	7	;CMD 0X13詢問目前MOTOR1狀態
  1403     0242  0784               	addwf	4,f
  1404     0243  3000               	movlw	0
  1405     0244  0080               	movwf	0
  1406     0245  3021               	movlw	33
  1407     0246  0085               	movwf	5
  1408     0247  3040               	movlw	64
  1409     0248  0084               	movwf	4
  1410     0249  3015               	movlw	21
  1411     024A  0784               	addwf	4,f
  1412     024B  3007               	movlw	7
  1413     024C  0784               	addwf	4,f
  1414     024D  3000               	movlw	0
  1415     024E  0080               	movwf	0
  1416                           
  1417                           ;---------------------------------------------------------------------------
  1418     024F  3021               	movlw	33
  1419     0250  0085               	movwf	5
  1420     0251  3040               	movlw	64
  1421     0252  0084               	movwf	4
  1422     0253  0180               	clrf	0
  1423     0254  0A84               	incf	4,f
  1424                           
  1425                           ;-------------
  1426     0255  0180               	clrf	0
  1427     0256  0A84               	incf	4,f
  1428                           
  1429                           ;-------------
  1430     0257  0180               	clrf	0
  1431     0258  0A84               	incf	4,f
  1432                           
  1433                           ;-------------
  1434     0259  0180               	clrf	0
  1435     025A  0A84               	incf	4,f
  1436                           
  1437                           ;-------------
  1438                           ;=============================================
  1439     025B  3021               	movlw	33
  1440     025C  0085               	movwf	5
  1441     025D  3040               	movlw	64
  1442     025E  0084               	movwf	4
  1443     025F  3015               	movlw	21
  1444     0260  0784               	addwf	4,f
  1445     0261  0180               	clrf	0
  1446     0262  0A84               	incf	4,f
  1447                           
  1448                           ;-------------
  1449     0263  0180               	clrf	0
  1450     0264  0A84               	incf	4,f
  1451                           
  1452                           ;-------------
  1453     0265  0180               	clrf	0
  1454     0266  0A84               	incf	4,f
  1455                           
  1456                           ;-------------
  1457     0267  0180               	clrf	0
  1458     0268  0A84               	incf	4,f
  1459                           
  1460                           ;-------------
  1461     0269  0008               	return
  1462     026A                     RECOVER_MODULE_LOOP:	
  1463                           ;-----------------------------------------------------
  1464                           ;停止動作
  1465                           
  1466     026A  0027               	banksel	908
  1467     026B  3000               	movlw	0
  1468     026C  00A7               	movwf	167
  1469     026D  3000               	movlw	0
  1470     026E  00A3               	movwf	163
  1471     026F  0020               	banksel	12
  1472     0270  222C               	call	RECOVER_MODULE_LOOP_LV1
  1473     0271  123A               	bcf	58,4
  1474     0272  0008               	return
  1475     0273                     RESET_STEP_FUNCTION:	
  1476                           ;--------------------------------------------------------------------------
  1477                           ;---------------------------------------------------------------------------
  1478                           ;---------------------------------------------------------------------------
  1479                           ;========================================================
  1480                           ;=============ADDR IS 0X04===============================
  1481                           ;========================================================
  1482                           
  1483     0273  1839               	btfsc	57,0
  1484     0274  2278               	call	STRONG_RESET_MOTOR_1_FUNC
  1485     0275  18B9               	btfsc	57,1
  1486     0276  227D               	call	STRONG_RESET_MOTOR_2_FUNC
  1487     0277  2A15               	goto	ANAY_MODBUS_CMD_06_EXIT
  1488     0278                     STRONG_RESET_MOTOR_1_FUNC:
  1489     0278  0022               	banksel	270
  1490     0279  108E               	bcf	270,1
  1491     027A  0020               	banksel	12
  1492     027B  1672               	bsf	114,4
  1493     027C  0008               	return
  1494     027D                     STRONG_RESET_MOTOR_2_FUNC:
  1495     027D  1632               	bsf	50,4
  1496     027E  0008               	return
  1497     027F                     CW_STEP_FUNCTION:	
  1498                           ;========================================================
  1499                           ;=============ADDR IS 0X00===============================
  1500                           ;========================================================
  1501                           
  1502     027F  1839               	btfsc	57,0
  1503     0280  2284               	call	STRONG_CW_MOTOR_1_FUNC
  1504     0281  18B9               	btfsc	57,1
  1505     0282  228C               	call	STRONG_CW_MOTOR_2_FUNC
  1506     0283  2A15               	goto	ANAY_MODBUS_CMD_06_EXIT
  1507     0284                     STRONG_CW_MOTOR_1_FUNC:
  1508     0284  0022               	banksel	270
  1509     0285  108E               	bcf	270,1
  1510     0286  0020               	banksel	12
  1511     0287  143C               	bsf	60,0
  1512     0288  1672               	bsf	114,4
  1513     0289  14B0               	bsf	48,1
  1514     028A  14F2               	bsf	114,1
  1515     028B  0008               	return
  1516     028C                     STRONG_CW_MOTOR_2_FUNC:
  1517     028C  14B0               	bsf	48,1
  1518     028D  14B2               	bsf	50,1
  1519     028E  0008               	return
  1520     028F                     CCW_STEP_FUNCTION:	
  1521                           ;========================================================
  1522                           ;=============ADDR IS 0X01===============================
  1523                           ;========================================================
  1524                           
  1525     028F  1839               	btfsc	57,0
  1526     0290  2294               	call	STRONG_CCW_MOTOR_1_FUNC
  1527     0291  18B9               	btfsc	57,1
  1528     0292  229C               	call	STRONG_CCW_MOTOR_2_FUNC
  1529     0293  2A15               	goto	ANAY_MODBUS_CMD_06_EXIT
  1530     0294                     STRONG_CCW_MOTOR_1_FUNC:
  1531     0294  0022               	banksel	270
  1532     0295  148E               	bsf	270,1
  1533     0296  0020               	banksel	12
  1534     0297  143C               	bsf	60,0
  1535     0298  1672               	bsf	114,4
  1536     0299  14B0               	bsf	48,1
  1537     029A  14F2               	bsf	114,1
  1538     029B  0008               	return
  1539     029C                     STRONG_CCW_MOTOR_2_FUNC:
  1540     029C  14B0               	bsf	48,1
  1541     029D  14B2               	bsf	50,1
  1542     029E  0008               	return
  1543     029F                     STRONG_STOP_FUNCTION:	
  1544                           ;========================================================
  1545                           ;=============ADDR IS 0X09===============================
  1546                           ;========================================================
  1547                           
  1548     029F  1839               	btfsc	57,0
  1549     02A0  22A4               	call	STRONG_STOP_MOTOR_1_FUNC
  1550     02A1  18B9               	btfsc	57,1
  1551     02A2  22B2               	call	STRONG_STOP_MOTOR_2_FUNC
  1552                           
  1553                           ; BTFSC FLAG2_BANK0,NOW_MOTOR_1_FLAG
  1554                           ; CALL STRONG_STOP_MOTOR_1_FUNC
  1555                           ; BTFSC FLAG2_BANK0,NOW_MOTOR_1_FLAG
  1556                           ; CALL STRONG_STOP_MOTOR_1_FUNC
  1557     02A3  2A15               	goto	ANAY_MODBUS_CMD_06_EXIT
  1558     02A4                     STRONG_STOP_MOTOR_1_FUNC:
  1559     02A4  3021               	movlw	33
  1560     02A5  0085               	movwf	5
  1561     02A6  3040               	movlw	64
  1562     02A7  0084               	movwf	4
  1563     02A8  3007               	movlw	7
  1564     02A9  0784               	addwf	4,f
  1565     02AA  3004               	movlw	4
  1566     02AB  0080               	movwf	0
  1567                           
  1568                           ;----------
  1569     02AC  3001               	movlw	1
  1570     02AD  00C2               	movwf	66
  1571     02AE  0022               	banksel	270
  1572     02AF  100E               	bcf	270,0
  1573     02B0  0020               	banksel	12
  1574     02B1  0008               	return
  1575     02B2                     STRONG_STOP_MOTOR_2_FUNC:
  1576     02B2  3021               	movlw	33
  1577     02B3  0085               	movwf	5
  1578     02B4  3040               	movlw	64
  1579     02B5  0084               	movwf	4
  1580     02B6  3015               	movlw	21
  1581     02B7  0784               	addwf	4,f
  1582     02B8  3007               	movlw	7
  1583     02B9  0784               	addwf	4,f
  1584     02BA  3004               	movlw	4
  1585     02BB  0080               	movwf	0
  1586                           
  1587                           ;----------
  1588     02BC  3001               	movlw	1
  1589     02BD  00C3               	movwf	67
  1590     02BE  0022               	banksel	270
  1591     02BF  110E               	bcf	270,2
  1592     02C0  0020               	banksel	12
  1593     02C1  0008               	return
  1594     02C2                     WRITE_MOTOR_1_SOME_DATA:	
  1595                           ;----------------------------------------------------------
  1596                           
  1597     02C2  1439               	bsf	57,0
  1598     02C3  3021               	movlw	33
  1599     02C4  0085               	movwf	5
  1600     02C5  3040               	movlw	64
  1601     02C6  0084               	movwf	4
  1602     02C7  29EC               	goto	ANAY_MODBUS_CMD_06_LEVEL1
  1603     02C8                     WRITE_MOTOR_2_SOME_DATA:
  1604     02C8  14B9               	bsf	57,1
  1605     02C9  3021               	movlw	33
  1606     02CA  0085               	movwf	5
  1607     02CB  3040               	movlw	64
  1608     02CC  0084               	movwf	4
  1609     02CD  3015               	movlw	21
  1610     02CE  0784               	addwf	4,f
  1611     02CF  29EC               	goto	ANAY_MODBUS_CMD_06_LEVEL1
  1612     02D0                     WRITE_MOTOR_3_SOME_DATA:
  1613     02D0  1539               	bsf	57,2
  1614     02D1  3021               	movlw	33
  1615     02D2  0085               	movwf	5
  1616     02D3  3040               	movlw	64
  1617     02D4  0084               	movwf	4
  1618     02D5  302A               	movlw	42
  1619     02D6  0784               	addwf	4,f
  1620     02D7  29EC               	goto	ANAY_MODBUS_CMD_06_LEVEL1
  1621     02D8                     WRITE_MOTOR_4_SOME_DATA:
  1622     02D8  15B9               	bsf	57,3
  1623     02D9  3021               	movlw	33
  1624     02DA  0085               	movwf	5
  1625     02DB  3040               	movlw	64
  1626     02DC  0084               	movwf	4
  1627     02DD  303F               	movlw	63
  1628     02DE  0784               	addwf	4,f
  1629     02DF  29EC               	goto	ANAY_MODBUS_CMD_06_LEVEL1
  1630     02E0                     MODBUS_RTU_READ_LV2:	
  1631                           ;========================================================
  1632                           ;=============MODBUS 計算其CRC 功能======================
  1633                           ;========================================================
  1634                           
  1635     02E0  0020               	banksel	12
  1636     02E1  30FF               	movlw	255
  1637     02E2  00A8               	movwf	40
  1638     02E3  30FF               	movlw	255
  1639     02E4  00A9               	movwf	41
  1640                           
  1641                           ;---------
  1642     02E5  3020               	movlw	32
  1643     02E6  0087               	movwf	7
  1644     02E7  30B0               	movlw	176
  1645     02E8  0086               	movwf	6
  1646     02E9  300A               	movlw	10
  1647     02EA  0786               	addwf	6,f	;這裡是第一筆資料的位置
  1648     02EB                     MODBUS_RTU_READ_CRC_LOOP:	
  1649                           ;---------
  1650                           
  1651     02EB  0801               	movf	1,w
  1652     02EC  00A7               	movwf	39
  1653     02ED  270D               	call	CRC_16_FUNCTION_LOOP
  1654     02EE  0A86               	incf	6,f
  1655     02EF  0BAA               	decfsz	42,f
  1656     02F0  2AEB               	goto	MODBUS_RTU_READ_CRC_LOOP
  1657     02F1  0829               	movf	41,w
  1658     02F2  0081               	movwf	1
  1659     02F3  0A86               	incf	6,f
  1660     02F4  0828               	movf	40,w
  1661     02F5  0081               	movwf	1
  1662     02F6  0008               	return
  1663     02F7                     SYSTEM_START_SETTING:	
  1664                           ;========================================================
  1665                           ;================== 主程序前參數設定 ====================
  1666                           ;========================================================
  1667                           
  1668                           
  1669                           ;========================================================
  1670                           ;=====================振盪器設定=========================
  1671                           ;========================================================
  1672     02F7  0021               	banksel	153
  1673     02F8  3072               	movlw	114
  1674     02F9  0099               	movwf	153	;8MHZ
  1675     02FA  3000               	movlw	0
  1676     02FB  0098               	movwf	152	;校正後頻率
  1677     02FC  3011               	movlw	17
  1678     02FD  009A               	movwf	154	;高頻振盪精度0.5%
  1679                           
  1680                           ;========================================================
  1681                           ;=====================OPTION設定=========================
  1682                           ;========================================================
  1683     02FE  30C8               	movlw	200
  1684     02FF  0095               	movwf	149	;BIT6 0->rising 1->falling
  1685                           
  1686                           ;========================================================
  1687                           ;======================中斷設定==========================
  1688                           ;========================================================
  1689     0300  3040               	movlw	64
  1690     0301  008B               	movwf	11
  1691     0302  0021               	banksel	145
  1692     0303  3000               	movlw	0
  1693     0304  0091               	movwf	145	;BIT 3 = MSSP 1 INTERRUPT, BIT 5 = USART 1 RECIEVE INTERRUPT
  1694     0305  3000               	movlw	0
  1695     0306  0092               	movwf	146
  1696     0307  3000               	movlw	0
  1697     0308  0093               	movwf	147
  1698     0309  3000               	movlw	0
  1699     030A  0094               	movwf	148
  1700                           
  1701                           ;========================================================
  1702                           ;========================ADC設定=========================
  1703                           ;========================================================
  1704     030B  0021               	banksel	157
  1705     030C  3000               	movlw	0
  1706     030D  009D               	movwf	157
  1707     030E  3000               	movlw	0
  1708     030F  009E               	movwf	158
  1709     0310  0023               	banksel	396
  1710     0311  018C               	clrf	396
  1711     0312  0190               	clrf	400
  1712     0313  0028               	banksel	1036
  1713     0314  018C               	clrf	1036
  1714     0315  018D               	clrf	1037
  1715     0316  0020               	banksel	12
  1716                           
  1717                           ;========================================================
  1718                           ;=====================I/O設定============================
  1719                           ;========================================================
  1720     0317  0021               	banksel	140
  1721     0318  30C0               	movlw	192
  1722     0319  008C               	movwf	140
  1723     031A  30FF               	movlw	255
  1724     031B  008D               	movwf	141
  1725     031C  3000               	movlw	0
  1726     031D  008E               	movwf	142
  1727     031E  300F               	movlw	15
  1728     031F  008F               	movwf	143
  1729     0320  30FF               	movlw	255
  1730     0321  0090               	movwf	144
  1731     0322  0026               	banksel	780
  1732     0323  3000               	movlw	0
  1733     0324  008C               	movwf	780
  1734     0325  30F6               	movlw	246
  1735     0326  008D               	movwf	781
  1736                           
  1737                           ;---------------
  1738     0327  0022               	banksel	268
  1739     0328  3000               	movlw	0
  1740     0329  008C               	movwf	268
  1741     032A  3000               	movlw	0
  1742     032B  008D               	movwf	269
  1743     032C  3000               	movlw	0
  1744     032D  008E               	movwf	270
  1745     032E  3000               	movlw	0
  1746     032F  008F               	movwf	271
  1747     0330  3000               	movlw	0
  1748     0331  0090               	movwf	272
  1749     0332  0027               	banksel	908
  1750     0333  018C               	clrf	908
  1751     0334  018D               	clrf	909
  1752                           
  1753                           ;---------------
  1754     0335  0020               	banksel	12
  1755     0336  018C               	clrf	12
  1756     0337  018D               	clrf	13
  1757     0338  018E               	clrf	14
  1758     0339  018F               	clrf	15
  1759     033A  0190               	clrf	16
  1760                           
  1761                           ;---------------
  1762     033B  0025               	banksel	652
  1763     033C  018C               	clrf	652
  1764     033D  018D               	clrf	653
  1765     033E  0020               	banksel	12
  1766     033F  277A               	call	DELAY_1000ms
  1767                           
  1768                           ;========================================================
  1769                           ;=====================暫存器設定=========================
  1770                           ;========================================================
  1771     0340  2743               	call	CLEAN_ALL_REGISTER
  1772     0341  3188               	pagesel	2048
  1773     0342  
                 warning: (2090) fixup overflow storing 0xD08 in 2 bytes
                 2508               	call	SET_MODBUS_MODE_ENABLE	;設定uart2硬體
  1774     0343  3180               	pagesel	0
  1775                           
  1776                           ;========================================================
  1777                           ;=====================TIMER2設定=========================
  1778                           ;========================================================
  1779     0344  2732               	call	SET_TMR2_BASE_TIME	;設定TIMER2基礎時間
  1780     0345  273B               	call	SET_TMR2_INT_EN	;TIMER2中斷啟動
  1781     0346  273F               	call	SET_TMR2_ON	;啟動TIMER2功能
  1782     0347                     ADC_HW_SETTING:	
  1783                           ;========================================================
  1784                           ;=====================ADC設定============================
  1785                           ;========================================================
  1786                           
  1787     0347  0028               	banksel	1037
  1788     0348  3010               	movlw	16
  1789     0349  008D               	movwf	1037
  1790                           
  1791                           ;-------------------------ADC_OPEN-------------------------
  1792     034A  0021               	banksel	158
  1793     034B  3031               	movlw	49	;AN12啟動
  1794     034C  009D               	movwf	157
  1795     034D  30C0               	movlw	192
  1796     034E  009E               	movwf	158
  1797     034F  0020               	banksel	12
  1798     0350  277F               	call	DELAY_100ms
  1799     0351                     SETTING_PWM_HW_LOOP:	
  1800                           ;========================================================
  1801                           ;=====================PWM輸出設定========================
  1802                           ;========================================================
  1803                           
  1804                           
  1805                           ;-------------------------------------設定相對應接腳TIMER
  1806     0351  0025               	banksel	670
  1807     0352  30DF               	movlw	223
  1808     0353  009E               	movwf	670
  1809     0354  300F               	movlw	15
  1810     0355  009F               	movwf	671
  1811                           
  1812                           ;-------------------------------------決定週期
  1813     0356  0028               	banksel	1046
  1814     0357  309C               	movlw	156
  1815     0358  0096               	movwf	1046
  1816                           
  1817                           ;-------------------------------------啟動TIMER
  1818     0359  0028               	banksel	1047
  1819     035A  307F               	movlw	127
  1820     035B  0097               	movwf	1047
  1821                           
  1822                           ;-------------------------------------決定DUTY CYCLE
  1823     035C  0026               	banksel	785
  1824     035D  3032               	movlw	50
  1825     035E  0091               	movwf	785
  1826                           
  1827                           ;-------------------------------------啟動PWM
  1828     035F  0026               	banksel	787
  1829     0360  300C               	movlw	12
  1830     0361  0093               	movwf	787
  1831     0362                     IOC_HW_SETTING:	
  1832                           ;========================================================
  1833                           ;=====================IOC設定============================
  1834                           ;========================================================
  1835                           
  1836     0362  0027               	banksel	916
  1837     0363  3000               	movlw	0
  1838     0364  0095               	movwf	917
  1839     0365  3000               	movlw	0
  1840     0366  0094               	movwf	916	;正緣觸發
  1841     0367                     CHECK_PWM_FREQ_FUCNTION:	
  1842 ;;========================================================
  1843 ;;=====================DIP SWITCH判斷=====================
  1844 ;;========================================================
  1845                           ;DIP_SWITCH_ADR_FUNCTION:
  1846                           ;BANKSEL ADDR_0_1_2_3_PORT
  1847                           ; BTFSC ADDR_0_1_2_3_PORT,ADDSEL_0
  1848                           ; BSF MOTOR1_FLAG0,MOTOR_1_EN
  1849 ;;---------
  1850                           ; BTFSC ADDR_0_1_2_3_PORT,ADDSEL_1
  1851                           ; BSF MOTOR2_FLAG0,MOTOR_2_EN
  1852 ;;---------
  1853                           ; BTFSC ADDR_0_1_2_3_PORT,ADDSEL_2
  1854                           ; BSF MOTOR3_FLAG0,MOTOR_3_EN
  1855 ;;---------
  1856                           ; BTFSC ADDR_0_1_2_3_PORT,ADDSEL_3
  1857                           ; BSF MOTOR4_FLAG0,MOTOR_4_EN
  1858                           ;---------
  1859                           ;========================================================
  1860                           ;=====================PWM頻率偵測========================
  1861                           ;========================================================
  1862                           
  1863     0367                     ID_SELECT_LOOP:	
  1864                           ;CALL ADC_TAKE_DATA_FUNCTION
  1865                           ;========================================================
  1866                           ;=====================ID SELECT==========================
  1867                           ;========================================================
  1868                           
  1869     0367  0020               	banksel	12
  1870     0368  01A5               	clrf	37
  1871     0369  1B0C               	btfsc	12,6
  1872     036A  1425               	bsf	37,0
  1873     036B  1B8C               	btfsc	12,7
  1874     036C  14A5               	bsf	37,1
  1875     036D  1B8D               	btfsc	13,7
  1876     036E  1525               	bsf	37,2
  1877     036F  1B0D               	btfsc	13,6
  1878     0370  15A5               	bsf	37,3
  1879     0371                     POWER_LED_OUTPUT_FUNCTION:	
  1880                           ;========================================================
  1881                           ;===================POWER LED輸出========================
  1882                           ;========================================================
  1883                           
  1884     0371  0020               	banksel	13
  1885     0372  1E8D               	btfss	13,5
  1886     0373  2B76               	goto	POWER_LED_OUTPUT_EXIT
  1887     0374  0027               	banksel	908
  1888     0375  140C               	bsf	908,0
  1889     0376                     POWER_LED_OUTPUT_EXIT:
  1890     0376  0020               	banksel	12
  1891     0377                     INT_HW_SETTING:	
  1892                           ;--------------------------------------------------------
  1893                           ;--------------------------------------------------------
  1894                           ;========================================================
  1895                           ;=====================INT設定============================
  1896                           ;========================================================
  1897                           
  1898     0377  0027               	banksel	909
  1899     0378  118D               	bcf	909,3	;將MAX485設定為RX模式
  1900     0379  160B               	bsf	11,4
  1901     037A  158B               	bsf	11,3
  1902     037B  0021               	banksel	148
  1903     037C  1694               	bsf	148,5
  1904     037D  1491               	bsf	145,1
  1905     037E  178B               	bsf	11,7
  1906     037F  0020               	banksel	12
  1907     0380  3002               	movlw	2
  1908     0381  00C8               	movwf	72
  1909     0382  3004               	movlw	4
  1910     0383  00A4               	movwf	36
  1911                           
  1912                           ; MOVLW 0X06
  1913                           ;MOVWF MODULE_ID_DAT
  1914     0384  0022               	banksel	268
  1915     0385  160C               	bsf	268,4
  1916     0386  168C               	bsf	268,5
  1917     0387  100E               	bcf	270,0
  1918     0388  110E               	bcf	270,2
  1919     0389  108E               	bcf	270,1
  1920     038A  118E               	bcf	270,3
  1921     038B  0027               	banksel	908
  1922     038C  01A0               	clrf	160
  1923     038D  3004               	movlw	4
  1924     038E  00A1               	movwf	161
  1925                           
  1926                           ;-----------------
  1927     038F  01A2               	clrf	162
  1928     0390  3000               	movlw	0
  1929     0391  00A3               	movwf	163
  1930                           
  1931                           ;-----------------
  1932     0392  01A4               	clrf	164
  1933     0393  3000               	movlw	0
  1934     0394  00A5               	movwf	165
  1935                           
  1936                           ;-----------------
  1937     0395  01A6               	clrf	166
  1938     0396  3000               	movlw	0
  1939     0397  00A7               	movwf	167
  1940     0398  0020               	banksel	12
  1941                           
  1942                           ;MOVLW 0X04
  1943                           ;MOVWF MODULE_ID_DAT
  1944     0399  2BA9               	goto	SYSTEM_START
  1945     039A                     TEST_FUNCTION_LOOP:
  1946     039A  0020               	banksel	12
  1947     039B  2783               	call	DELAY_10ms
  1948     039C  0027               	banksel	909
  1949     039D  158D               	bsf	909,3
  1950     039E                     TEST_FUNCTION_LOOP1:	
  1951                           ;---------------------------------------------
  1952                           
  1953     039E  0029               	banksel	1174
  1954     039F  1C96               	btfss	1174,1
  1955     03A0  2B9E               	goto	TEST_FUNCTION_LOOP1
  1956     03A1  0029               	banksel	1170
  1957     03A2  30A5               	movlw	165
  1958     03A3  0092               	movwf	1170
  1959     03A4  0020               	banksel	12
  1960     03A5                     TEST_FUNCTION_LOOP2:
  1961     03A5  0029               	banksel	1174
  1962     03A6  1C96               	btfss	1174,1
  1963     03A7  2BA5               	goto	TEST_FUNCTION_LOOP2
  1964     03A8  2B9A               	goto	TEST_FUNCTION_LOOP
  1965     03A9                     SYSTEM_START:	
  1966                           ;CALL MOTOR_1_ZERO_FUNCTION
  1967                           ;CALL MOTOR_2_ZERO_FUNCTION
  1968                           ;********************************************************************************
  1969                           ;********************************************************************************
  1970                           ;========================================================
  1971                           ;=====================主程序迴圈=========================
  1972                           ;========================================================
  1973                           
  1974     03A9  0020               	banksel	12
  1975     03AA                     SYSTEM_START_LV1:	
  1976                           ; BTFSC PORTE,0X00
  1977                           ; GOTO MOTOR_2_WORK1
  1978                           ; GOTO MOTOR_2_STOP
  1979                           ;BANKSEL PORTA
  1980                           
  1981                           
  1982                           ;-------------------------------------------
  1983     03AA  183B               	btfsc	59,0
  1984     03AB  2494               	call	MODBUS_ERROR_CODE_01_LOOP
  1985     03AC  18BB               	btfsc	59,1
  1986     03AD  24A8               	call	MODBUS_ERROR_CODE_02_LOOP
  1987     03AE  193B               	btfsc	59,2
  1988     03AF  24B6               	call	MODBUS_ERROR_CODE_03_LOOP
  1989     03B0  19BB               	btfsc	59,3
  1990     03B1  24C4               	call	MODBUS_ERROR_CODE_04_LOOP
  1991     03B2  1A3B               	btfsc	59,4
  1992     03B3  24D2               	call	MODBUS_ERROR_CODE_05_LOOP
  1993     03B4  1ABB               	btfsc	59,5
  1994     03B5  24E0               	call	MODBUS_ERROR_CODE_06_LOOP
  1995                           
  1996                           ;-------------------------------------------
  1997     03B6  1830               	btfsc	48,0
  1998     03B7  26B7               	call	PREPARE_TX_DATA_LOOP
  1999     03B8  2BA9               	goto	SYSTEM_START
  2000                           
  2001                           ;-----------
  2002     03B9  18B0               	btfsc	48,1
  2003     03BA  24EE               	call	MODULE_WORK_LOOP	;順逆轉馬達動作
  2004                           
  2005                           ;-----------
  2006     03BB  1A32               	btfsc	50,4
  2007     03BC  2478               	call	MOTOR_2_ZERO_FUNCTION
  2008     03BD  1AB2               	btfsc	50,5
  2009     03BE  23DC               	call	CHECK_MOTOR2_ZERO_LOOP
  2010                           
  2011                           ;--------------------------------------
  2012     03BF  1A72               	btfsc	114,4
  2013     03C0  244B               	call	MOTOR_1_ZERO_FUNCTION
  2014     03C1  1B72               	btfsc	114,6
  2015     03C2  242D               	call	MOTOR1_ZERO_IN_HI_LOOP
  2016     03C3  1AF2               	btfsc	114,5
  2017     03C4  2403               	call	MOTOR1_ZERO_IN_LO_LOOP
  2018     03C5  2BA9               	goto	SYSTEM_START
  2019     03C6                     MOTOR_2_WORK1:	
  2020                           ;--------------------------------------
  2021                           
  2022     03C6  3021               	movlw	33
  2023     03C7  0085               	movwf	5
  2024     03C8  3040               	movlw	64
  2025     03C9  0084               	movwf	4
  2026     03CA  3015               	movlw	21
  2027     03CB  0784               	addwf	4,f
  2028     03CC  300F               	movlw	15
  2029     03CD  0784               	addwf	4,f
  2030     03CE  3000               	movlw	0
  2031     03CF  0080               	movwf	0
  2032     03D0  2BAA               	goto	SYSTEM_START_LV1
  2033     03D1                     MOTOR_2_STOP:
  2034     03D1  3021               	movlw	33
  2035     03D2  0085               	movwf	5
  2036     03D3  3040               	movlw	64
  2037     03D4  0084               	movwf	4
  2038     03D5  3015               	movlw	21
  2039     03D6  0784               	addwf	4,f
  2040     03D7  300F               	movlw	15
  2041     03D8  0784               	addwf	4,f
  2042     03D9  30FF               	movlw	255
  2043     03DA  0080               	movwf	0
  2044     03DB  2BAA               	goto	SYSTEM_START_LV1
  2045     03DC                     CHECK_MOTOR2_ZERO_LOOP:	
  2046                           ;========================================================
  2047                           ;=====================注射馬達復位完成===================
  2048                           ;========================================================
  2049                           
  2050     03DC  1A3A               	btfsc	58,4
  2051     03DD  0008               	return
  2052     03DE  18B6               	btfsc	54,1
  2053     03DF  0008               	return
  2054     03E0  1810               	btfsc	16,0
  2055     03E1  0008               	return
  2056     03E2  0022               	banksel	270
  2057     03E3  110E               	bcf	270,2
  2058     03E4  0020               	banksel	12
  2059     03E5  01C3               	clrf	67
  2060     03E6  0020               	banksel	12
  2061     03E7  12B2               	bcf	50,5
  2062     03E8  1036               	bcf	54,0
  2063                           
  2064                           ;-----------------------------
  2065     03E9  3021               	movlw	33
  2066     03EA  0085               	movwf	5
  2067     03EB  3040               	movlw	64
  2068     03EC  0084               	movwf	4
  2069     03ED  3015               	movlw	21
  2070     03EE  0784               	addwf	4,f
  2071     03EF  3004               	movlw	4
  2072     03F0  0784               	addwf	4,f
  2073     03F1  0180               	clrf	0
  2074     03F2  0A84               	incf	4,f
  2075     03F3  0180               	clrf	0
  2076                           
  2077                           ;---------------------------------------------清除累加步數
  2078     03F4  3021               	movlw	33
  2079     03F5  0085               	movwf	5
  2080     03F6  3040               	movlw	64
  2081     03F7  0084               	movwf	4
  2082     03F8  3015               	movlw	21
  2083     03F9  0784               	addwf	4,f
  2084     03FA  3007               	movlw	7
  2085     03FB  0784               	addwf	4,f
  2086     03FC  3000               	movlw	0
  2087     03FD  0080               	movwf	0
  2088     03FE  0027               	banksel	908
  2089     03FF  3000               	movlw	0
  2090     0400  00A3               	movwf	163
  2091     0401  0020               	banksel	12
  2092     0402  0008               	return
  2093     0403                     MOTOR1_ZERO_IN_LO_LOOP:	
  2094                           ;--------------------------------------------
  2095                           
  2096     0403  1A3A               	btfsc	58,4
  2097     0404  0008               	return
  2098     0405  18B5               	btfsc	53,1
  2099     0406  0008               	return
  2100     0407  1D0D               	btfss	13,2
  2101     0408  2C42               	goto	MOTOR1_TIME_ZERO_LOOP
  2102     0409  3001               	movlw	1
  2103     040A  07D1               	addwf	81,f
  2104     040B  3000               	movlw	0
  2105     040C  3DD0               	addwfc	80,f
  2106     040D  30FD               	movlw	253
  2107     040E  0750               	addwf	80,w
  2108     040F  1C03               	btfss	3,0
  2109     0410  0008               	return
  2110     0411  300C               	movlw	12
  2111     0412  0751               	addwf	81,w
  2112     0413  1C03               	btfss	3,0
  2113     0414  0008               	return
  2114     0415                     MOTOR1_ZERO_IN_LO_LOOP_LV1:	
  2115                           ; MOVF IOC_COUNTER_HBYTE,W
  2116                           ; BTFSS STATUS,Z
  2117                           ; GOTO MOTOR1_ZERO_IN_LO_LOOP_LV1
  2118 ;;------
  2119                           ; MOVLW 0XFE
  2120                           ; ADDWF IOC_COUNTER_LBYTE,W
  2121                           ; BTFSS STATUS,C
  2122                           ; RETURN
  2123                           
  2124     0415  0022               	banksel	270
  2125     0416  100E               	bcf	270,0
  2126     0417  0020               	banksel	12
  2127     0418  13F2               	bcf	114,7
  2128     0419  12F2               	bcf	114,5
  2129     041A  10BA               	bcf	58,1
  2130     041B  3021               	movlw	33
  2131     041C  0085               	movwf	5
  2132     041D  3040               	movlw	64
  2133     041E  0084               	movwf	4
  2134     041F  3007               	movlw	7
  2135     0420  0784               	addwf	4,f
  2136     0421  3000               	movlw	0
  2137     0422  0080               	movwf	0
  2138                           
  2139                           ;----------
  2140     0423  3000               	movlw	0
  2141     0424  00C2               	movwf	66
  2142     0425  1035               	bcf	53,0
  2143     0426  0027               	banksel	908
  2144     0427  3000               	movlw	0
  2145     0428  00A3               	movwf	163
  2146     0429  0020               	banksel	12
  2147     042A  183C               	btfsc	60,0
  2148     042B  2D0F               	goto	RESET_END_IN_NORMAL_LOOP
  2149                           
  2150                           ;BANKSEL IOCBN
  2151                           ; BSF IOCBN,0X02
  2152                           ; BCF IOCBP,0X02
  2153                           ;BANKSEL PORTA
  2154     042C  0008               	return
  2155     042D                     MOTOR1_ZERO_IN_HI_LOOP:	
  2156                           ;-------------------------------------------------------------
  2157                           ;-------------------------------------------------------------
  2158                           
  2159     042D  1A3A               	btfsc	58,4
  2160     042E  0008               	return
  2161     042F  18B5               	btfsc	53,1
  2162     0430  0008               	return
  2163     0431  190D               	btfsc	13,2
  2164     0432  2C42               	goto	MOTOR1_TIME_ZERO_LOOP
  2165     0433  3001               	movlw	1
  2166     0434  07D1               	addwf	81,f
  2167     0435  3000               	movlw	0
  2168     0436  3DD0               	addwfc	80,f
  2169     0437  30FD               	movlw	253
  2170     0438  0750               	addwf	80,w
  2171     0439  1C03               	btfss	3,0
  2172     043A  0008               	return
  2173     043B  300C               	movlw	12
  2174     043C  0751               	addwf	81,w
  2175     043D  1C03               	btfss	3,0
  2176     043E  0008               	return
  2177     043F                     MOTOR1_ZERO_IN_HI_LOOP_LV1:	
  2178                           ; MOVF IOC_COUNTER_HBYTE,W
  2179                           ; BTFSS STATUS,Z
  2180                           ; GOTO MOTOR1_ZERO_IN_HI_LOOP_LV1
  2181 ;;------
  2182                           ; MOVLW 0XFE
  2183                           ; ADDWF IOC_COUNTER_LBYTE,W
  2184                           ; BTFSS STATUS,C
  2185                           ; RETURN
  2186                           
  2187     043F  13F2               	bcf	114,7
  2188     0440  1372               	bcf	114,6
  2189     0441  2C64               	goto	MOTOR_1_NOW_IS_LO
  2190     0442                     MOTOR1_TIME_ZERO_LOOP:
  2191                           
  2192                           ;CLRF IOC_COUNTER_HBYTE
  2193                           ;CLRF IOC_COUNTER_LBYTE
  2194     0442  0AD3               	incf	83,f
  2195     0443  309C               	movlw	156
  2196     0444  0753               	addwf	83,w
  2197     0445  1C03               	btfss	3,0
  2198     0446  0008               	return
  2199     0447  01D3               	clrf	83
  2200     0448  01D1               	clrf	81
  2201     0449  01D0               	clrf	80
  2202     044A  0008               	return
  2203     044B                     MOTOR_1_ZERO_FUNCTION:	
  2204                           ;========================================================
  2205                           ;=====================轉向馬達復位=======================
  2206                           ;========================================================
  2207                           
  2208     044B  1A3A               	btfsc	58,4
  2209     044C  0008               	return
  2210     044D  18B5               	btfsc	53,1
  2211     044E  0008               	return
  2212     044F  1435               	bsf	53,0
  2213     0450  0027               	banksel	908
  2214     0451  3001               	movlw	1
  2215     0452  00A3               	movwf	163
  2216     0453  0020               	banksel	12
  2217     0454  1272               	bcf	114,4
  2218                           
  2219                           ;-----------
  2220     0455  3021               	movlw	33
  2221     0456  0085               	movwf	5
  2222     0457  3040               	movlw	64
  2223     0458  0084               	movwf	4
  2224     0459  3007               	movlw	7
  2225     045A  0784               	addwf	4,f
  2226     045B  3004               	movlw	4
  2227     045C  0080               	movwf	0
  2228                           
  2229                           ;----------
  2230     045D  3001               	movlw	1
  2231     045E  00C2               	movwf	66
  2232     045F  0022               	banksel	270
  2233     0460  140E               	bsf	270,0
  2234                           
  2235                           ;BCF MOTOR_CONTROL_PORT,M1_FR
  2236                           ; BSF MOTOR_CONTROL_PORT,M1_FR
  2237     0461  0020               	banksel	12
  2238     0462  190D               	btfsc	13,2
  2239     0463  2C6E               	goto	MOTOR_1_NOW_IS_HI	;目前是HI
  2240     0464                     MOTOR_1_NOW_IS_LO:
  2241                           
  2242                           ;目前是LO
  2243     0464  0020               	banksel	12
  2244     0465  16F2               	bsf	114,5
  2245     0466  1372               	bcf	114,6
  2246     0467  14BA               	bsf	58,1
  2247     0468  01C6               	clrf	70
  2248     0469  01C7               	clrf	71
  2249     046A  01D0               	clrf	80
  2250     046B  01D1               	clrf	81
  2251     046C  01D3               	clrf	83
  2252     046D  0008               	return
  2253     046E                     MOTOR_1_NOW_IS_HI:
  2254     046E  0020               	banksel	12
  2255     046F  1772               	bsf	114,6
  2256     0470  12F2               	bcf	114,5
  2257     0471  14BA               	bsf	58,1
  2258     0472  01C6               	clrf	70
  2259     0473  01C7               	clrf	71
  2260     0474  01D0               	clrf	80
  2261     0475  01D1               	clrf	81
  2262     0476  01D3               	clrf	83
  2263     0477  0008               	return
  2264     0478                     MOTOR_2_ZERO_FUNCTION:	
  2265                           ;========================================================
  2266                           ;=====================注射馬達復位進行中=================
  2267                           ;========================================================
  2268                           
  2269     0478  1A3A               	btfsc	58,4
  2270     0479  0008               	return
  2271     047A  18B6               	btfsc	54,1
  2272     047B  0008               	return
  2273     047C  1232               	bcf	50,4
  2274     047D  1C10               	btfss	16,0
  2275     047E  0008               	return
  2276     047F  0027               	banksel	908
  2277     0480  3001               	movlw	1
  2278     0481  00A3               	movwf	163
  2279     0482  0020               	banksel	12
  2280     0483  1436               	bsf	54,0
  2281                           
  2282                           ; MOVLW MODBUS_DAT_REAL_ADRH
  2283                           ; MOVWF FSR0H
  2284                           ; MOVLW MODBUS_DAT_REAL_ADRL
  2285                           ; MOVWF FSR0L
  2286                           ; MOVLW 0X15
  2287                           ; ADDWF FSR0L,F
  2288                           ; MOVLW 0X0F
  2289                           ; ADDWF FSR0L,F
  2290                           ; MOVLW 0X00
  2291                           ; MOVWF INDF0
  2292                           ;------------------------------------
  2293     0484  3021               	movlw	33
  2294     0485  0085               	movwf	5
  2295     0486  3040               	movlw	64
  2296     0487  0084               	movwf	4
  2297     0488  3015               	movlw	21
  2298     0489  0784               	addwf	4,f
  2299     048A  3007               	movlw	7
  2300     048B  0784               	addwf	4,f
  2301     048C  3001               	movlw	1
  2302     048D  0080               	movwf	0
  2303     048E  0022               	banksel	270
  2304     048F  118E               	bcf	270,3
  2305     0490  150E               	bsf	270,2
  2306     0491  0020               	banksel	12
  2307     0492  16B2               	bsf	50,5
  2308     0493  0008               	return
  2309     0494                     MODBUS_ERROR_CODE_01_LOOP:	
  2310                           ;========================================================
  2311                           ;===============MODBUS ERROR CODE IS 01==================
  2312                           ;========================================================
  2313                           
  2314     0494  103B               	bcf	59,0
  2315     0495  3020               	movlw	32
  2316     0496  0087               	movwf	7
  2317     0497  30B0               	movlw	176
  2318     0498  0086               	movwf	6
  2319     0499  300A               	movlw	10
  2320     049A  0786               	addwf	6,f
  2321                           
  2322                           ;---------------------
  2323     049B  0A86               	incf	6,f
  2324     049C  3080               	movlw	128
  2325     049D  0481               	iorwf	1,f
  2326     049E  0A86               	incf	6,f
  2327     049F  3001               	movlw	1
  2328     04A0  0081               	movwf	1
  2329     04A1                     MODBUS_ERROR_CODE_END:	
  2330                           ;--------------------
  2331                           
  2332     04A1  3003               	movlw	3
  2333     04A2  00AA               	movwf	42
  2334     04A3  22E0               	call	MODBUS_RTU_READ_LV2
  2335     04A4  3005               	movlw	5
  2336     04A5  00AD               	movwf	45
  2337     04A6  1430               	bsf	48,0
  2338     04A7  0008               	return
  2339     04A8                     MODBUS_ERROR_CODE_02_LOOP:	
  2340                           ;========================================================
  2341                           ;===============MODBUS ERROR CODE IS 02==================
  2342                           ;========================================================
  2343                           
  2344     04A8  10BB               	bcf	59,1
  2345     04A9  3020               	movlw	32
  2346     04AA  0087               	movwf	7
  2347     04AB  30B0               	movlw	176
  2348     04AC  0086               	movwf	6
  2349     04AD  300A               	movlw	10
  2350     04AE  0786               	addwf	6,f
  2351                           
  2352                           ;---------------------
  2353     04AF  0A86               	incf	6,f
  2354     04B0  3080               	movlw	128
  2355     04B1  0481               	iorwf	1,f
  2356     04B2  0A86               	incf	6,f
  2357     04B3  3002               	movlw	2
  2358     04B4  0081               	movwf	1
  2359                           
  2360                           ;--------------------
  2361     04B5  2CA1               	goto	MODBUS_ERROR_CODE_END
  2362     04B6                     MODBUS_ERROR_CODE_03_LOOP:	
  2363                           ;========================================================
  2364                           ;===============MODBUS ERROR CODE IS 03==================
  2365                           ;========================================================
  2366                           
  2367     04B6  113B               	bcf	59,2
  2368     04B7  3020               	movlw	32
  2369     04B8  0087               	movwf	7
  2370     04B9  30B0               	movlw	176
  2371     04BA  0086               	movwf	6
  2372     04BB  300A               	movlw	10
  2373     04BC  0786               	addwf	6,f
  2374                           
  2375                           ;---------------------
  2376     04BD  0A86               	incf	6,f
  2377     04BE  3080               	movlw	128
  2378     04BF  0481               	iorwf	1,f
  2379     04C0  0A86               	incf	6,f
  2380     04C1  3003               	movlw	3
  2381     04C2  0081               	movwf	1
  2382                           
  2383                           ;--------------------
  2384     04C3  2CA1               	goto	MODBUS_ERROR_CODE_END
  2385     04C4                     MODBUS_ERROR_CODE_04_LOOP:	
  2386                           ;========================================================
  2387                           ;===============MODBUS ERROR CODE IS 04==================
  2388                           ;========================================================
  2389                           
  2390     04C4  11BB               	bcf	59,3
  2391     04C5  3020               	movlw	32
  2392     04C6  0087               	movwf	7
  2393     04C7  30B0               	movlw	176
  2394     04C8  0086               	movwf	6
  2395     04C9  300A               	movlw	10
  2396     04CA  0786               	addwf	6,f
  2397                           
  2398                           ;---------------------
  2399     04CB  0A86               	incf	6,f
  2400     04CC  3080               	movlw	128
  2401     04CD  0481               	iorwf	1,f
  2402     04CE  0A86               	incf	6,f
  2403     04CF  3004               	movlw	4
  2404     04D0  0081               	movwf	1
  2405                           
  2406                           ;--------------------
  2407     04D1  2CA1               	goto	MODBUS_ERROR_CODE_END
  2408     04D2                     MODBUS_ERROR_CODE_05_LOOP:	
  2409                           ;========================================================
  2410                           ;===============MODBUS ERROR CODE IS 05==================
  2411                           ;========================================================
  2412                           
  2413     04D2  123B               	bcf	59,4
  2414     04D3  3020               	movlw	32
  2415     04D4  0087               	movwf	7
  2416     04D5  30B0               	movlw	176
  2417     04D6  0086               	movwf	6
  2418     04D7  300A               	movlw	10
  2419     04D8  0786               	addwf	6,f
  2420                           
  2421                           ;---------------------
  2422     04D9  0A86               	incf	6,f
  2423     04DA  3080               	movlw	128
  2424     04DB  0481               	iorwf	1,f
  2425     04DC  0A86               	incf	6,f
  2426     04DD  3005               	movlw	5
  2427     04DE  0081               	movwf	1
  2428                           
  2429                           ;--------------------
  2430     04DF  2CA1               	goto	MODBUS_ERROR_CODE_END
  2431     04E0                     MODBUS_ERROR_CODE_06_LOOP:	
  2432                           ;========================================================
  2433                           ;===============MODBUS ERROR CODE IS 06==================
  2434                           ;========================================================
  2435                           
  2436     04E0  12BB               	bcf	59,5
  2437     04E1  3020               	movlw	32
  2438     04E2  0087               	movwf	7
  2439     04E3  30B0               	movlw	176
  2440     04E4  0086               	movwf	6
  2441     04E5  300A               	movlw	10
  2442     04E6  0786               	addwf	6,f
  2443                           
  2444                           ;---------------------
  2445     04E7  0A86               	incf	6,f
  2446     04E8  3080               	movlw	128
  2447     04E9  0481               	iorwf	1,f
  2448     04EA  0A86               	incf	6,f
  2449     04EB  3006               	movlw	6
  2450     04EC  0081               	movwf	1
  2451                           
  2452                           ;--------------------
  2453     04ED  2CA1               	goto	MODBUS_ERROR_CODE_END
  2454     04EE                     MODULE_WORK_LOOP:	
  2455                           ;********************************************************************************
  2456                           ;********************************************************************************
  2457                           ;========================================================
  2458                           ;================執行MODULE動作副程式====================
  2459                           ;========================================================
  2460                           
  2461     04EE  1A3A               	btfsc	58,4
  2462     04EF  0008               	return
  2463                           
  2464                           ; BTFSC MOTOR1_FLAG0,MOTOR_1_EN
  2465                           ; CALL MOTOR_1_WORKING_LOOP
  2466 ;;-----
  2467                           ; BTFSC MOTOR2_FLAG0,MOTOR_2_EN
  2468                           ; CALL MOTOR_2_WORKING_LOOP
  2469                           ;-----
  2470                           ; BTFSC FLAG0_BANK0,MOTOR_1_EN
  2471                           ; CALL MOTOR_1_WORKING_LOOP
  2472 ;;-----
  2473                           ; BTFSC FLAG0_BANK0,MOTOR_1_EN
  2474                           ; CALL MOTOR_1_WORKING_LOOP
  2475                           ;-----
  2476     04F0  0008               	return
  2477     04F1                     MOTOR_1_WORKING_LOOP:	
  2478                           ;========================================================
  2479                           ;================馬達1動作副程式=========================
  2480                           ;========================================================
  2481                           
  2482                           
  2483                           ;BTFSC MOTOR1_FLAG1,MOTOR1_IN_ZERO_FLAG
  2484                           ;RETURN
  2485     04F1  1CF2               	btfss	114,1
  2486     04F2  0008               	return
  2487                           
  2488                           ;BSF MOTOR1_FLAG1,MOTOR1_IN_ROAT_FLAG
  2489     04F3  0027               	banksel	908
  2490     04F4  3001               	movlw	1
  2491     04F5  00A3               	movwf	163
  2492     04F6  0020               	banksel	12
  2493     04F7  0008               	return
  2494     04F8  1972               	btfsc	114,2
  2495     04F9  2D38               	goto	MOTOR_1_WORK_CW_LV1
  2496     04FA  19F2               	btfsc	114,3
  2497     04FB  2DA1               	goto	MOTOR_1_WORK_CCW_LV1
  2498                           
  2499                           ;----------------------------------
  2500     04FC  3021               	movlw	33
  2501     04FD  0085               	movwf	5
  2502     04FE  3040               	movlw	64
  2503     04FF  0084               	movwf	4
  2504     0500  0800               	movf	0,w
  2505     0501  1D03               	btfss	3,2
  2506     0502  2D21               	goto	MOTOR_1_WORK_CW_LOOP
  2507                           
  2508                           ;-------------
  2509     0503  0A84               	incf	4,f
  2510     0504  0800               	movf	0,w
  2511     0505  1D03               	btfss	3,2
  2512     0506  2D21               	goto	MOTOR_1_WORK_CW_LOOP
  2513                           
  2514                           ;-------------
  2515     0507  0A84               	incf	4,f
  2516     0508  0800               	movf	0,w
  2517     0509  1D03               	btfss	3,2
  2518     050A  2D8B               	goto	MOTOR_1_WORK_CCW_LOOP
  2519                           
  2520                           ;-------------
  2521     050B  0A84               	incf	4,f
  2522     050C  0800               	movf	0,w
  2523     050D  1D03               	btfss	3,2
  2524     050E  2D8B               	goto	MOTOR_1_WORK_CCW_LOOP
  2525     050F                     RESET_END_IN_NORMAL_LOOP:	
  2526                           ;-------------
  2527                           
  2528     050F  10F2               	bcf	114,1
  2529     0510  10BA               	bcf	58,1
  2530     0511  01C6               	clrf	70
  2531     0512  01C7               	clrf	71
  2532     0513  3021               	movlw	33
  2533     0514  0085               	movwf	5
  2534     0515  3040               	movlw	64
  2535     0516  0084               	movwf	4
  2536     0517  3007               	movlw	7	;CMD 0X13詢問目前MOTOR1狀態
  2537     0518  0784               	addwf	4,f
  2538     0519  3000               	movlw	0
  2539     051A  0080               	movwf	0
  2540     051B  10B5               	bcf	53,1
  2541     051C  0027               	banksel	908
  2542     051D  3000               	movlw	0
  2543     051E  00A3               	movwf	163
  2544     051F  0020               	banksel	12
  2545                           
  2546                           ;----------
  2547     0520  0008               	return
  2548     0521                     MOTOR_1_WORK_CW_LOOP:	
  2549                           ;========================================================
  2550                           ;================馬達1順時針副程式=======================
  2551                           ;========================================================
  2552                           
  2553     0521  0020               	banksel	13
  2554     0522  1D0D               	btfss	13,2
  2555     0523  0008               	return
  2556     0524  0022               	banksel	270
  2557     0525  140E               	bsf	270,0
  2558     0526  108E               	bcf	270,1
  2559     0527  0020               	banksel	12
  2560     0528  3021               	movlw	33
  2561     0529  0085               	movwf	5
  2562     052A  3040               	movlw	64
  2563     052B  0084               	movwf	4
  2564     052C  3007               	movlw	7
  2565     052D  0784               	addwf	4,f
  2566     052E  3001               	movlw	1
  2567     052F  0080               	movwf	0
  2568                           
  2569                           ;----------
  2570     0530  01C0               	clrf	64
  2571     0531  1572               	bsf	114,2
  2572     0532  14BA               	bsf	58,1
  2573     0533  01C6               	clrf	70
  2574     0534  01C7               	clrf	71
  2575     0535  190D               	btfsc	13,2
  2576     0536  2D70               	goto	MOTOR_1_CW_IOC_SET_HI
  2577     0537  11BA               	bcf	58,3
  2578     0538                     MOTOR_1_WORK_CW_LV1:	
  2579                           ;BTFSC PORTB,0X02
  2580                           ;GOTO MOTOR_1_CW_IOC_SET_HI
  2581                           ;BANKSEL IOCBN
  2582                           ; BCF IOCBN,0X02
  2583                           ; BSF IOCBP,0X02
  2584                           ;BANKSEL PORTA
  2585                           
  2586     0538  3021               	movlw	33
  2587     0539  0085               	movwf	5
  2588     053A  3040               	movlw	64
  2589     053B  0084               	movwf	4
  2590                           
  2591                           ;----------------------------------
  2592     053C  0800               	movf	0,w
  2593     053D  1D03               	btfss	3,2
  2594     053E  2D44               	goto	MOTOR_1_WORK_CW_LV3
  2595     053F  0A84               	incf	4,f
  2596     0540  0800               	movf	0,w
  2597     0541  1D03               	btfss	3,2
  2598     0542  2D44               	goto	MOTOR_1_WORK_CW_LV3
  2599     0543  2D54               	goto	MOTOR_1_WORK_CW_FINISH
  2600     0544                     MOTOR_1_WORK_CW_LV3:
  2601                           
  2602                           ;BANKSEL PORTF
  2603                           ;BSF PORTF,0X01
  2604                           ;BCF PORTF,0X01
  2605                           ;BANKSEL PORTA
  2606                           ; MOVF PWM_1_COUNT_DAT,W
  2607                           ; BTFSC STATUS,Z
  2608                           ; RETURN
  2609     0544  1DBA               	btfss	58,3
  2610     0545  2D81               	goto	CHECK_IOC_IS_LO
  2611     0546  2D72               	goto	CHECK_IOC_IS_HI
  2612     0547                     MOTOR_1_WORK_CW_LV4:
  2613                           
  2614                           ;BANKSEL PORTF
  2615                           ;BSF PORTF,0X01
  2616                           ;BCF PORTF,0X01
  2617     0547  0020               	banksel	12
  2618     0548  01C0               	clrf	64
  2619     0549  3021               	movlw	33
  2620     054A  0085               	movwf	5
  2621     054B  3040               	movlw	64
  2622     054C  0084               	movwf	4
  2623                           
  2624                           ;----------------------------------
  2625     054D  0800               	movf	0,w
  2626     054E  1D03               	btfss	3,2
  2627     054F  2D59               	goto	MOTOR_1_WORK_CW_LV2
  2628     0550  0A84               	incf	4,f
  2629     0551  0800               	movf	0,w
  2630     0552  1D03               	btfss	3,2
  2631     0553  2D59               	goto	MOTOR_1_WORK_CW_LV2
  2632     0554                     MOTOR_1_WORK_CW_FINISH:
  2633                           
  2634                           ;BANKSEL PORTF
  2635                           ;BSF PORTF,0X00
  2636                           ;BCF PORTF,0X00
  2637                           ;BANKSEL PORTA
  2638     0554  0022               	banksel	270
  2639     0555  100E               	bcf	270,0
  2640     0556  0020               	banksel	12
  2641     0557  1172               	bcf	114,2
  2642     0558  0008               	return
  2643     0559                     MOTOR_1_WORK_CW_LV2:
  2644     0559  0020               	banksel	12
  2645     055A  3021               	movlw	33
  2646     055B  0085               	movwf	5
  2647     055C  3040               	movlw	64
  2648     055D  0084               	movwf	4
  2649     055E  0A84               	incf	4,f
  2650     055F  3001               	movlw	1
  2651     0560  0280               	subwf	0,f
  2652     0561  0384               	decf	4,f
  2653     0562  3000               	movlw	0
  2654     0563  3B80               	subwfb	0,f
  2655                           
  2656                           ;----------------------------------------------------------
  2657     0564  3021               	movlw	33
  2658     0565  0085               	movwf	5
  2659     0566  3040               	movlw	64
  2660     0567  0084               	movwf	4
  2661     0568  3005               	movlw	5
  2662     0569  0784               	addwf	4,f
  2663     056A  3001               	movlw	1
  2664     056B  0780               	addwf	0,f
  2665     056C  0384               	decf	4,f
  2666     056D  3000               	movlw	0
  2667     056E  3D80               	addwfc	0,f
  2668     056F  0008               	return
  2669     0570                     MOTOR_1_CW_IOC_SET_HI:	
  2670                           ;----------------------------------------------------------
  2671                           
  2672     0570  15BA               	bsf	58,3
  2673     0571  2D38               	goto	MOTOR_1_WORK_CW_LV1
  2674     0572                     CHECK_IOC_IS_HI:
  2675     0572  190D               	btfsc	13,2
  2676     0573  0008               	return
  2677     0574  0846               	movf	70,w
  2678     0575  1D03               	btfss	3,2
  2679     0576  2D7C               	goto	MOTOR_1_WORK_CW_LV5
  2680                           
  2681                           ;------
  2682     0577  30FE               	movlw	254
  2683     0578  0747               	addwf	71,w
  2684     0579  1C03               	btfss	3,0
  2685     057A  0008               	return
  2686     057B  2D7C               	goto	MOTOR_1_WORK_CW_LV5
  2687     057C                     MOTOR_1_WORK_CW_LV5:
  2688                           
  2689                           ;BANKSEL PORTF
  2690                           ;BSF PORTF,0X00
  2691                           ;BCF PORTF,0X00
  2692     057C  0020               	banksel	12
  2693     057D  01C6               	clrf	70
  2694     057E  01C7               	clrf	71
  2695     057F  11BA               	bcf	58,3
  2696     0580  0008               	return
  2697     0581                     CHECK_IOC_IS_LO:	
  2698                           ;-----------------------------------------------
  2699                           
  2700     0581  1D0D               	btfss	13,2
  2701     0582  0008               	return
  2702     0583  0846               	movf	70,w
  2703     0584  1D03               	btfss	3,2
  2704     0585  2D47               	goto	MOTOR_1_WORK_CW_LV4
  2705                           
  2706                           ;------
  2707     0586  30FE               	movlw	254
  2708     0587  0747               	addwf	71,w
  2709     0588  1C03               	btfss	3,0
  2710     0589  0008               	return
  2711     058A  2D47               	goto	MOTOR_1_WORK_CW_LV4
  2712     058B                     MOTOR_1_WORK_CCW_LOOP:	
  2713                           ;========================================================
  2714                           ;================馬達1逆時針副程式=======================
  2715                           ;========================================================
  2716                           
  2717     058B  0022               	banksel	270
  2718     058C  140E               	bsf	270,0
  2719     058D  148E               	bsf	270,1
  2720     058E  0020               	banksel	12
  2721     058F  3021               	movlw	33
  2722     0590  0085               	movwf	5
  2723     0591  3040               	movlw	64
  2724     0592  0084               	movwf	4
  2725     0593  3007               	movlw	7
  2726     0594  0784               	addwf	4,f
  2727     0595  3001               	movlw	1
  2728     0596  0080               	movwf	0
  2729                           
  2730                           ;----------
  2731     0597  1D0D               	btfss	13,2
  2732     0598  0008               	return
  2733     0599  01C0               	clrf	64
  2734     059A  15F2               	bsf	114,3
  2735     059B  14BA               	bsf	58,1
  2736     059C  01C6               	clrf	70
  2737     059D  01C7               	clrf	71
  2738     059E  190D               	btfsc	13,2
  2739     059F  2DDD               	goto	MOTOR_1_CCW_IOC_SET_HI
  2740     05A0  11BA               	bcf	58,3
  2741     05A1                     MOTOR_1_WORK_CCW_LV1:
  2742     05A1  3021               	movlw	33
  2743     05A2  0085               	movwf	5
  2744     05A3  3040               	movlw	64
  2745     05A4  0084               	movwf	4
  2746     05A5  3002               	movlw	2
  2747     05A6  0784               	addwf	4,f
  2748                           
  2749                           ;----------------------------------
  2750     05A7  0800               	movf	0,w
  2751     05A8  1D03               	btfss	3,2
  2752     05A9  2DAF               	goto	MOTOR_1_WORK_CCW_LV3
  2753     05AA  0A84               	incf	4,f
  2754     05AB  0800               	movf	0,w
  2755     05AC  1D03               	btfss	3,2
  2756     05AD  2DAF               	goto	MOTOR_1_WORK_CCW_LV3
  2757     05AE  2DC0               	goto	MOTOR_1_WORK_CCW_FINISH
  2758     05AF                     MOTOR_1_WORK_CCW_LV3:	
  2759                           ;----------------------------------
  2760                           
  2761                           
  2762                           ; MOVF PWM_1_COUNT_DAT,W
  2763                           ; BTFSC STATUS,Z
  2764                           ; RETURN
  2765     05AF  1DBA               	btfss	58,3
  2766     05B0  2DEB               	goto	CHECKC_IOC_IS_LO
  2767     05B1  2DDF               	goto	CHECKC_IOC_IS_HI
  2768     05B2                     MOTOR_1_WORK_CCW_LV4:
  2769     05B2  01C0               	clrf	64
  2770     05B3  3021               	movlw	33
  2771     05B4  0085               	movwf	5
  2772     05B5  3040               	movlw	64
  2773     05B6  0084               	movwf	4
  2774     05B7  3002               	movlw	2
  2775     05B8  0784               	addwf	4,f
  2776                           
  2777                           ;----------------------------------
  2778     05B9  0800               	movf	0,w
  2779     05BA  1D03               	btfss	3,2
  2780     05BB  2DC5               	goto	MOTOR_1_WORK_CCW_LV2
  2781     05BC  0A84               	incf	4,f
  2782     05BD  0800               	movf	0,w
  2783     05BE  1D03               	btfss	3,2
  2784     05BF  2DC5               	goto	MOTOR_1_WORK_CCW_LV2
  2785     05C0                     MOTOR_1_WORK_CCW_FINISH:
  2786     05C0  0022               	banksel	270
  2787     05C1  100E               	bcf	270,0
  2788     05C2  0020               	banksel	12
  2789     05C3  11F2               	bcf	114,3
  2790     05C4  0008               	return
  2791     05C5                     MOTOR_1_WORK_CCW_LV2:
  2792     05C5  0020               	banksel	12
  2793     05C6  3021               	movlw	33
  2794     05C7  0085               	movwf	5
  2795     05C8  3040               	movlw	64
  2796     05C9  0084               	movwf	4
  2797     05CA  3003               	movlw	3
  2798     05CB  0784               	addwf	4,f
  2799     05CC  3001               	movlw	1
  2800     05CD  0280               	subwf	0,f
  2801     05CE  0384               	decf	4,f
  2802     05CF  3000               	movlw	0
  2803     05D0  3B80               	subwfb	0,f
  2804                           
  2805                           ;----------------------------------------------
  2806     05D1  3021               	movlw	33
  2807     05D2  0085               	movwf	5
  2808     05D3  3040               	movlw	64
  2809     05D4  0084               	movwf	4
  2810     05D5  3005               	movlw	5
  2811     05D6  0784               	addwf	4,f
  2812     05D7  3001               	movlw	1
  2813     05D8  0280               	subwf	0,f
  2814     05D9  0384               	decf	4,f
  2815     05DA  3000               	movlw	0
  2816     05DB  3B80               	subwfb	0,f
  2817     05DC  0008               	return
  2818     05DD                     MOTOR_1_CCW_IOC_SET_HI:
  2819     05DD  15BA               	bsf	58,3
  2820     05DE  2DA1               	goto	MOTOR_1_WORK_CCW_LV1
  2821     05DF                     CHECKC_IOC_IS_HI:
  2822     05DF  190D               	btfsc	13,2
  2823     05E0  0008               	return
  2824     05E1  0846               	movf	70,w
  2825     05E2  1D03               	btfss	3,2
  2826     05E3  2DE9               	goto	MOTOR_1_WORK_CCW_LV5
  2827                           
  2828                           ;------
  2829     05E4  30FE               	movlw	254
  2830     05E5  0747               	addwf	71,w
  2831     05E6  1C03               	btfss	3,0
  2832     05E7  0008               	return
  2833     05E8  2DE9               	goto	MOTOR_1_WORK_CCW_LV5
  2834     05E9                     MOTOR_1_WORK_CCW_LV5:
  2835     05E9  11BA               	bcf	58,3
  2836     05EA  0008               	return
  2837     05EB                     CHECKC_IOC_IS_LO:
  2838     05EB  1D0D               	btfss	13,2
  2839     05EC  0008               	return
  2840     05ED  0846               	movf	70,w
  2841     05EE  1D03               	btfss	3,2
  2842     05EF  2DB2               	goto	MOTOR_1_WORK_CCW_LV4
  2843                           
  2844                           ;------
  2845     05F0  30FE               	movlw	254
  2846     05F1  0747               	addwf	71,w
  2847     05F2  1C03               	btfss	3,0
  2848     05F3  0008               	return
  2849     05F4  2DB2               	goto	MOTOR_1_WORK_CCW_LV4
  2850     05F5                     MOTOR_2_WORKING_LOOP:	
  2851                           ;========================================================
  2852                           ;================馬達2動作副程式=========================
  2853                           ;========================================================
  2854                           
  2855     05F5  1836               	btfsc	54,0
  2856     05F6  0008               	return
  2857     05F7  1CB2               	btfss	50,1
  2858     05F8  0008               	return
  2859     05F9  0027               	banksel	908
  2860     05FA  3001               	movlw	1
  2861     05FB  00A3               	movwf	163
  2862     05FC  0020               	banksel	12
  2863     05FD  14B6               	bsf	54,1
  2864     05FE  1932               	btfsc	50,2
  2865     05FF  2E39               	goto	MOTOR_2_WORK_CW_LV1
  2866     0600  19B2               	btfsc	50,3
  2867     0601  2E84               	goto	MOTOR_2_WORK_CCW_LV1
  2868                           
  2869                           ;----------------------------------
  2870     0602  3021               	movlw	33
  2871     0603  0085               	movwf	5
  2872     0604  3040               	movlw	64
  2873     0605  0084               	movwf	4
  2874     0606  3015               	movlw	21
  2875     0607  0784               	addwf	4,f
  2876                           
  2877                           ;----------
  2878     0608  0800               	movf	0,w
  2879     0609  1D03               	btfss	3,2
  2880     060A  2E29               	goto	MOTOR_2_WORK_CW_LOOP
  2881                           
  2882                           ;-------------
  2883     060B  0A84               	incf	4,f
  2884     060C  0800               	movf	0,w
  2885     060D  1D03               	btfss	3,2
  2886     060E  2E29               	goto	MOTOR_2_WORK_CW_LOOP
  2887                           
  2888                           ;-------------
  2889     060F  0A84               	incf	4,f
  2890     0610  0800               	movf	0,w
  2891     0611  1D03               	btfss	3,2
  2892     0612  2E74               	goto	MOTOR_2_WORK_CCW_LOOP
  2893                           
  2894                           ;-------------
  2895     0613  0A84               	incf	4,f
  2896     0614  0800               	movf	0,w
  2897     0615  1D03               	btfss	3,2
  2898     0616  2E74               	goto	MOTOR_2_WORK_CCW_LOOP
  2899     0617                     MOTOR_2_IOC_STOP_LOOP:	
  2900                           ;-------------
  2901                           
  2902     0617  0020               	banksel	12
  2903     0618  10B2               	bcf	50,1
  2904     0619  3021               	movlw	33
  2905     061A  0085               	movwf	5
  2906     061B  3040               	movlw	64
  2907     061C  0084               	movwf	4
  2908     061D  3015               	movlw	21
  2909     061E  0784               	addwf	4,f
  2910     061F  3007               	movlw	7
  2911     0620  0784               	addwf	4,f
  2912     0621  3000               	movlw	0
  2913     0622  0080               	movwf	0
  2914                           
  2915                           ;----------
  2916     0623  10B6               	bcf	54,1
  2917     0624  0027               	banksel	908
  2918     0625  3000               	movlw	0
  2919     0626  00A3               	movwf	163
  2920     0627  0020               	banksel	12
  2921     0628  0008               	return
  2922     0629                     MOTOR_2_WORK_CW_LOOP:	
  2923                           ;========================================================
  2924                           ;================馬達2順時針副程式=======================
  2925                           ;========================================================
  2926                           
  2927     0629  0022               	banksel	270
  2928     062A  150E               	bsf	270,2
  2929     062B  118E               	bcf	270,3
  2930     062C  0020               	banksel	12
  2931     062D  3021               	movlw	33
  2932     062E  0085               	movwf	5
  2933     062F  3040               	movlw	64
  2934     0630  0084               	movwf	4
  2935     0631  3015               	movlw	21
  2936     0632  0784               	addwf	4,f
  2937     0633  3007               	movlw	7
  2938     0634  0784               	addwf	4,f
  2939     0635  3001               	movlw	1	;MOTOR 2 IS WORKING
  2940     0636  0080               	movwf	0
  2941                           
  2942                           ;----------
  2943     0637  01C1               	clrf	65
  2944     0638  1532               	bsf	50,2
  2945     0639                     MOTOR_2_WORK_CW_LV1:
  2946     0639  1C10               	btfss	16,0
  2947     063A  2E4C               	goto	MOTOR_2_WORK_CW_FINISH
  2948     063B  0841               	movf	65,w
  2949     063C  1903               	btfsc	3,2
  2950     063D  0008               	return
  2951     063E  01C1               	clrf	65
  2952     063F  3021               	movlw	33
  2953     0640  0085               	movwf	5
  2954     0641  3040               	movlw	64
  2955     0642  0084               	movwf	4
  2956     0643  3015               	movlw	21
  2957     0644  0784               	addwf	4,f
  2958                           
  2959                           ;----------------------------------
  2960     0645  0800               	movf	0,w
  2961     0646  1D03               	btfss	3,2
  2962     0647  2E5A               	goto	MOTOR_2_WORK_CW_LV2
  2963     0648  0A84               	incf	4,f
  2964     0649  0800               	movf	0,w
  2965     064A  1D03               	btfss	3,2
  2966     064B  2E5A               	goto	MOTOR_2_WORK_CW_LV2
  2967     064C                     MOTOR_2_WORK_CW_FINISH:
  2968     064C  3021               	movlw	33
  2969     064D  0085               	movwf	5
  2970     064E  3040               	movlw	64
  2971     064F  0084               	movwf	4
  2972     0650  3015               	movlw	21
  2973     0651  0784               	addwf	4,f
  2974                           
  2975                           ;----------
  2976     0652  0180               	clrf	0
  2977     0653  0A84               	incf	4,f
  2978     0654  0180               	clrf	0
  2979                           
  2980                           ;-------------------------------
  2981     0655  0022               	banksel	270
  2982     0656  110E               	bcf	270,2
  2983     0657  0020               	banksel	12
  2984     0658  1132               	bcf	50,2
  2985     0659  0008               	return
  2986     065A                     MOTOR_2_WORK_CW_LV2:
  2987     065A  3021               	movlw	33
  2988     065B  0085               	movwf	5
  2989     065C  3040               	movlw	64
  2990     065D  0084               	movwf	4
  2991     065E  3015               	movlw	21
  2992     065F  0784               	addwf	4,f
  2993                           
  2994                           ;------------
  2995     0660  0A84               	incf	4,f
  2996     0661  3001               	movlw	1
  2997     0662  0280               	subwf	0,f
  2998     0663  0384               	decf	4,f
  2999     0664  3000               	movlw	0
  3000     0665  3B80               	subwfb	0,f
  3001                           
  3002                           ;------------------
  3003     0666  3021               	movlw	33
  3004     0667  0085               	movwf	5
  3005     0668  3040               	movlw	64
  3006     0669  0084               	movwf	4
  3007     066A  3015               	movlw	21
  3008     066B  0784               	addwf	4,f
  3009     066C  3005               	movlw	5
  3010     066D  0784               	addwf	4,f
  3011     066E  3001               	movlw	1
  3012     066F  0280               	subwf	0,f
  3013     0670  0384               	decf	4,f
  3014     0671  3000               	movlw	0
  3015     0672  3B80               	subwfb	0,f
  3016     0673  0008               	return
  3017     0674                     MOTOR_2_WORK_CCW_LOOP:	
  3018                           ;========================================================
  3019                           ;================馬達2逆時針副程式=======================
  3020                           ;========================================================
  3021                           
  3022     0674  0022               	banksel	270
  3023     0675  150E               	bsf	270,2
  3024     0676  158E               	bsf	270,3
  3025     0677  0020               	banksel	12
  3026     0678  3021               	movlw	33
  3027     0679  0085               	movwf	5
  3028     067A  3040               	movlw	64
  3029     067B  0084               	movwf	4
  3030     067C  3015               	movlw	21
  3031     067D  0784               	addwf	4,f
  3032     067E  3007               	movlw	7
  3033     067F  0784               	addwf	4,f
  3034     0680  3001               	movlw	1	;馬達正在運作中
  3035     0681  0080               	movwf	0
  3036                           
  3037                           ;----------
  3038     0682  01C1               	clrf	65
  3039     0683  15B2               	bsf	50,3
  3040     0684                     MOTOR_2_WORK_CCW_LV1:
  3041     0684  0841               	movf	65,w
  3042     0685  1903               	btfsc	3,2
  3043     0686  0008               	return
  3044     0687  01C1               	clrf	65
  3045     0688  3021               	movlw	33
  3046     0689  0085               	movwf	5
  3047     068A  3040               	movlw	64
  3048     068B  0084               	movwf	4
  3049     068C  3015               	movlw	21
  3050     068D  0784               	addwf	4,f
  3051     068E  3002               	movlw	2
  3052     068F  0784               	addwf	4,f
  3053                           
  3054                           ;----------------------------------
  3055     0690  0800               	movf	0,w
  3056     0691  1D03               	btfss	3,2
  3057     0692  2E9C               	goto	MOTOR_2_WORK_CCW_LV2
  3058     0693  0A84               	incf	4,f
  3059     0694  0800               	movf	0,w
  3060     0695  1D03               	btfss	3,2
  3061     0696  2E9C               	goto	MOTOR_2_WORK_CCW_LV2
  3062     0697                     MOTOR_2_WORK_CCW_FINISH:
  3063     0697  0022               	banksel	270
  3064     0698  110E               	bcf	270,2
  3065     0699  0020               	banksel	12
  3066     069A  11B2               	bcf	50,3
  3067     069B  0008               	return
  3068     069C                     MOTOR_2_WORK_CCW_LV2:
  3069     069C  3021               	movlw	33
  3070     069D  0085               	movwf	5
  3071     069E  3040               	movlw	64
  3072     069F  0084               	movwf	4
  3073     06A0  3015               	movlw	21
  3074     06A1  0784               	addwf	4,f
  3075                           
  3076                           ;INCF FSR0L,F
  3077     06A2  3003               	movlw	3
  3078     06A3  0784               	addwf	4,f
  3079     06A4  3001               	movlw	1
  3080     06A5  0280               	subwf	0,f
  3081     06A6  0384               	decf	4,f
  3082     06A7  3000               	movlw	0
  3083     06A8  3B80               	subwfb	0,f
  3084                           
  3085                           ;-------------------------
  3086     06A9  3021               	movlw	33
  3087     06AA  0085               	movwf	5
  3088     06AB  3040               	movlw	64
  3089     06AC  0084               	movwf	4
  3090     06AD  3015               	movlw	21
  3091     06AE  0784               	addwf	4,f
  3092     06AF  3005               	movlw	5
  3093     06B0  0784               	addwf	4,f
  3094     06B1  3001               	movlw	1
  3095     06B2  0780               	addwf	0,f
  3096     06B3  0384               	decf	4,f
  3097     06B4  3000               	movlw	0
  3098     06B5  3D80               	addwfc	0,f
  3099     06B6  0008               	return
  3100     06B7                     PREPARE_TX_DATA_LOOP:	
  3101                           ;========================================================
  3102                           ;====================準備TX資料副程式====================
  3103                           ;========================================================
  3104                           
  3105                           
  3106                           ; MOVLW 0X08
  3107                           ; MOVWF WATCH_COUNTER
  3108                           ; CALL WATCH_SUB_FUNCTION
  3109     06B7  0020               	banksel	12
  3110     06B8  2783               	call	DELAY_10ms
  3111     06B9  3020               	movlw	32
  3112     06BA  0087               	movwf	7
  3113     06BB  30B0               	movlw	176
  3114     06BC  0086               	movwf	6
  3115     06BD  300A               	movlw	10
  3116     06BE  0786               	addwf	6,f
  3117     06BF  0027               	banksel	909
  3118     06C0  158D               	bsf	909,3
  3119     06C1  2788               	call	DELAY_1ms
  3120     06C2  0020               	banksel	12
  3121     06C3                     TEST_MAX485_LOOP1:	
  3122                           ;---------------------------------------------
  3123                           
  3124     06C3  0029               	banksel	1174
  3125     06C4  1C96               	btfss	1174,1
  3126     06C5  2EC3               	goto	TEST_MAX485_LOOP1
  3127     06C6  0029               	banksel	1170
  3128     06C7  0801               	movf	1,w
  3129     06C8  0092               	movwf	1170
  3130     06C9  0020               	banksel	12
  3131     06CA  0A86               	incf	6,f
  3132     06CB  0BAD               	decfsz	45,f
  3133     06CC  2EC3               	goto	TEST_MAX485_LOOP1
  3134     06CD                     TEST_MAX485_LOOP1_LV1:
  3135     06CD  0029               	banksel	1174
  3136     06CE  1C96               	btfss	1174,1
  3137     06CF  2ECD               	goto	TEST_MAX485_LOOP1_LV1
  3138     06D0  0027               	banksel	909
  3139     06D1  118D               	bcf	909,3
  3140     06D2  0029               	banksel	1173
  3141     06D3  1615               	bsf	1173,4
  3142     06D4  0027               	banksel	908
  3143     06D5  3001               	movlw	1
  3144     06D6  00A5               	movwf	165
  3145     06D7  0020               	banksel	12
  3146     06D8  1030               	bcf	48,0
  3147     06D9  0008               	return
  3148     06DA                     ADC_TAKE_DATA_FUNCTION:	
  3149                           ;========================================================
  3150                           ;=====================ADC取資料副程式====================
  3151                           ;========================================================
  3152                           
  3153     06DA  0021               	banksel	158
  3154     06DB  3031               	movlw	49	;AN12啟動
  3155     06DC  009D               	movwf	157
  3156     06DD  30C0               	movlw	192
  3157     06DE  009E               	movwf	158
  3158     06DF  01FC               	clrf	124
  3159     06E0  01FD               	clrf	125
  3160     06E1  0020               	banksel	12
  3161     06E2  279B               	call	DELAY_100us
  3162     06E3  279B               	call	DELAY_100us
  3163     06E4  279B               	call	DELAY_100us
  3164     06E5  0021               	banksel	157
  3165                           
  3166 ;;------------------------ADC_RUN-------------------------------
  3167     06E6  149D               	bsf	157,1
  3168     06E7                     ADC_WORK:
  3169     06E7  189D               	btfsc	157,1
  3170     06E8  2EE7               	goto	ADC_WORK
  3171     06E9  0021               	banksel	156
  3172     06EA  081C               	movf	156,w
  3173     06EB  00FC               	movwf	124
  3174     06EC  081B               	movf	155,w
  3175     06ED  00FD               	movwf	125
  3176     06EE  0020               	banksel	12
  3177     06EF  0008               	return
  3178     06F0                     WATCH_SUB_FUNCTION:	
  3179                           ;========================================================
  3180                           ;====================測試用將資料送出====================
  3181                           ;========================================================
  3182                           ;這個部分是顯示內部資料的副程式
  3183                           
  3184     06F0  3020               	movlw	32
  3185     06F1  0085               	movwf	5
  3186     06F2  30BA               	movlw	186
  3187     06F3  0084               	movwf	4
  3188     06F4  3008               	movlw	8
  3189     06F5  00F1               	movwf	113
  3190     06F6  0800               	movf	0,w
  3191     06F7  00F2               	movwf	114
  3192     06F8                     WATCH_SUB_FUNC_LV1:
  3193     06F8  0022               	banksel	272
  3194     06F9  1310               	bcf	272,6
  3195     06FA  1BF2               	btfsc	114,7
  3196     06FB  1690               	bsf	272,5
  3197     06FC  1FF2               	btfss	114,7
  3198     06FD  1290               	bcf	272,5
  3199     06FE  1710               	bsf	272,6
  3200     06FF  0DF2               	rlf	114,f
  3201     0700  0BF1               	decfsz	113,f
  3202     0701  2EF8               	goto	WATCH_SUB_FUNC_LV1
  3203                           
  3204                           ;----------
  3205     0702  3008               	movlw	8
  3206     0703  00F1               	movwf	113
  3207     0704  0A84               	incf	4,f
  3208     0705  0800               	movf	0,w
  3209     0706  00F2               	movwf	114
  3210     0707  0BF0               	decfsz	112,f
  3211     0708  2EF8               	goto	WATCH_SUB_FUNC_LV1
  3212     0709  1290               	bcf	272,5
  3213     070A  1310               	bcf	272,6
  3214     070B  0020               	banksel	12
  3215     070C  0008               	return
  3216     070D                     CRC_16_FUNCTION_LOOP:	
  3217                           ;========================================================
  3218                           ;====================CRC-16運算副程式====================
  3219                           ;========================================================
  3220                           
  3221     070D  0020               	banksel	12
  3222     070E  0827               	movf	39,w
  3223     070F  06A9               	xorwf	41,f
  3224                           
  3225                           ;---------
  3226     0710  3009               	movlw	9
  3227     0711  00A6               	movwf	38
  3228     0712                     CRC_16_FUNCTION_LV1:
  3229     0712  03A6               	decf	38,f
  3230     0713  0826               	movf	38,w
  3231     0714  1903               	btfsc	3,2
  3232     0715  2F20               	goto	CRC_16_END_FUNCTION
  3233                           
  3234                           ;---------------------
  3235     0716  1003               	bcf	3,0
  3236     0717  0CA8               	rrf	40,f
  3237     0718  0CA9               	rrf	41,f
  3238     0719  1C03               	btfss	3,0
  3239     071A  2F12               	goto	CRC_16_FUNCTION_LV1
  3240                           
  3241                           ;---------------------
  3242     071B  30A0               	movlw	160	;CRC-16運算的參數
  3243     071C  06A8               	xorwf	40,f
  3244     071D  3001               	movlw	1
  3245     071E  06A9               	xorwf	41,f
  3246     071F  2F12               	goto	CRC_16_FUNCTION_LV1
  3247     0720                     CRC_16_END_FUNCTION:
  3248     0720  0020               	banksel	12
  3249     0721  0008               	return
  3250     0722                     AAAA_1800:	
  3251                           ;=======================================================
  3252                           ;===============測試將收到的資料顯示出==================OK
  3253                           ;=======================================================
  3254                           
  3255     0722  3008               	movlw	8
  3256     0723  00F0               	movwf	112
  3257     0724                     AAAAN:
  3258     0724  0027               	banksel	908
  3259     0725  100C               	bcf	908,0
  3260                           
  3261                           ;----------------
  3262     0726  1BF1               	btfsc	113,7
  3263     0727  150C               	bsf	908,2
  3264     0728  1FF1               	btfss	113,7
  3265     0729  110C               	bcf	908,2
  3266                           
  3267                           ;----------------
  3268     072A  140C               	bsf	908,0
  3269     072B  0DF1               	rlf	113,f
  3270     072C  0BF0               	decfsz	112,f
  3271     072D  2F24               	goto	AAAAN
  3272     072E  100C               	bcf	908,0
  3273     072F  110C               	bcf	908,2
  3274     0730  0020               	banksel	12
  3275     0731  0008               	return
  3276     0732                     SET_TMR2_BASE_TIME:	
  3277                           ;=======================================================
  3278                           ;================TIMER2基礎時間設定=====================OK
  3279                           ;=======================================================
  3280                           ;TIMER2 BASE TIME IS 1mS
  3281                           
  3282     0732  0020               	banksel	28
  3283     0733  3015               	movlw	21
  3284     0734  009C               	movwf	28
  3285     0735  30A7               	movlw	167
  3286     0736  009B               	movwf	27
  3287                           
  3288                           ;---------------------
  3289     0737  3004               	movlw	4
  3290     0738  00A3               	movwf	35
  3291     0739  0020               	banksel	12
  3292     073A  0008               	return
  3293     073B                     SET_TMR2_INT_EN:	
  3294                           ;=======================================================
  3295                           ;===============TIMER2中斷參數設定======================OK
  3296                           ;=======================================================
  3297                           
  3298     073B  0021               	banksel	145
  3299     073C  1491               	bsf	145,1
  3300     073D  0020               	banksel	12
  3301     073E  0008               	return
  3302     073F                     SET_TMR2_ON:	
  3303                           ;=======================================================
  3304                           ;===================TIMER2啟動==========================OK
  3305                           ;=======================================================
  3306                           
  3307     073F  0020               	banksel	28
  3308     0740  151C               	bsf	28,2
  3309     0741  0020               	banksel	12
  3310     0742  0008               	return
  3311     0743                     CLEAN_ALL_REGISTER:	
  3312                           ;========================================================
  3313                           ;=================將REG內資料全部清空====================OK
  3314                           ;========================================================
  3315                           
  3316     0743  3020               	movlw	32
  3317     0744  0087               	movwf	7
  3318     0745  3000               	movlw	0
  3319     0746  0086               	movwf	6
  3320     0747  3003               	movlw	3
  3321     0748  00F1               	movwf	113
  3322     0749  30FF               	movlw	255
  3323     074A  00F0               	movwf	112
  3324     074B                     CLEAN_ALL_REGISTER_LOOP:
  3325     074B  0181               	clrf	1
  3326     074C  1003               	bcf	3,0
  3327     074D  3001               	movlw	1
  3328     074E  0786               	addwf	6,f
  3329     074F  3000               	movlw	0
  3330     0750  3D87               	addwfc	7,f
  3331     0751  0BF0               	decfsz	112,f
  3332     0752  2F4B               	goto	CLEAN_ALL_REGISTER_LOOP
  3333     0753  30FF               	movlw	255
  3334     0754  00F0               	movwf	112
  3335     0755  0BF1               	decfsz	113,f
  3336     0756  2F4B               	goto	CLEAN_ALL_REGISTER_LOOP
  3337     0757  0020               	banksel	12
  3338     0758  0008               	return
  3339     0759                     READ_EEPROM:	
  3340                           ;=======================================================
  3341                           ;===================== 讀EEPROM ========================OK
  3342                           ;=======================================================
  3343                           
  3344     0759  0023               	banksel	401
  3345     075A  087E               	movf	126,w
  3346     075B  0091               	movwf	401
  3347     075C  1315               	bcf	405,6	;USER EEPROM
  3348     075D  1395               	bcf	405,7	;USER EEPROM
  3349     075E  1415               	bsf	405,0	;READ_EEPROM
  3350     075F  0813               	movf	403,w
  3351     0760  00FF               	movwf	127
  3352     0761  0020               	banksel	12
  3353     0762  0008               	return
  3354     0763                     WRITE_EEPROM:	
  3355                           ;=======================================================
  3356                           ;===================== 寫EEPROM ========================OK
  3357                           ;=======================================================
  3358                           
  3359     0763  138B               	bcf	11,7
  3360     0764  0023               	banksel	401
  3361     0765  087E               	movf	126,w
  3362     0766  0091               	movwf	401	;EEPROM ADDRESS
  3363     0767  087F               	movf	127,w
  3364     0768  0093               	movwf	403	;EEPROM DATA
  3365     0769                     WRITE_EEPROM_LOOP_1:	
  3366 ;;-----------------------
  3367                           
  3368     0769  1315               	bcf	405,6	;USER EEPROM
  3369     076A  1395               	bcf	405,7	;USER EEPROM
  3370     076B  1515               	bsf	405,2	;ENABLE WRITE
  3371     076C  3055               	movlw	85	;固定程序
  3372     076D  0096               	movwf	406
  3373     076E  30AA               	movlw	170
  3374     076F  0096               	movwf	406	;固定程序
  3375                           
  3376 ;;-----------------------
  3377     0770  1495               	bsf	405,1	;RUN WRITE EEPROM
  3378     0771                     WAIT_EEPROM_WRITE_OVER:
  3379     0771  1895               	btfsc	405,1
  3380     0772  2F71               	goto	WAIT_EEPROM_WRITE_OVER
  3381     0773  0023               	banksel	405
  3382     0774  1115               	bcf	405,2	;Disable writes
  3383     0775  0020               	banksel	12
  3384     0776  178B               	bsf	11,7
  3385     0777  0008               	return
  3386     0778                     DELAY_3000ms:	
  3387                           ;========================================================
  3388                           ;======================== DELAY =========================OK
  3389                           ;========================================================
  3390                           ;DEFINE IS 8MHZ
  3391                           
  3392     0778  277A               	call	DELAY_1000ms
  3393     0779  277A               	call	DELAY_1000ms
  3394     077A                     DELAY_1000ms:
  3395     077A  277B               	call	DELAY_500ms
  3396     077B                     DELAY_500ms:
  3397     077B  277F               	call	DELAY_100ms
  3398     077C  277F               	call	DELAY_100ms
  3399     077D  277F               	call	DELAY_100ms
  3400     077E  277F               	call	DELAY_100ms
  3401     077F                     DELAY_100ms:
  3402     077F  2782               	call	DELAY_20ms
  3403     0780  2781               	call	DELAY_40ms
  3404     0781                     DELAY_40ms:
  3405     0781  2782               	call	DELAY_20ms
  3406     0782                     DELAY_20ms:
  3407     0782  2783               	call	DELAY_10ms
  3408     0783                     DELAY_10ms:
  3409     0783  2784               	call	DELAY_5ms
  3410     0784                     DELAY_5ms:
  3411     0784  2788               	call	DELAY_1ms
  3412     0785                     DELAY_4ms:
  3413     0785  2788               	call	DELAY_1ms
  3414     0786                     DELAY_3ms:
  3415     0786  2788               	call	DELAY_1ms
  3416     0787                     DELAY_2ms:
  3417     0787  2788               	call	DELAY_1ms
  3418     0788                     DELAY_1ms:
  3419     0788  3031               	movlw	49
  3420     0789  00A0               	movwf	32	;49
  3421     078A  00A1               	movwf	33	;49
  3422     078B  300A               	movlw	10
  3423     078C  00A2               	movwf	34
  3424     078D  2F8E               	goto	DELAY_LOOP_1
  3425     078E                     DELAY_LOOP_1:
  3426     078E  0000               	nop	;1
  3427     078F  0BA0               	decfsz	32,f	;2
  3428     0790  2F8E               	goto	DELAY_LOOP_1	;3,4 (0.5*4*49 = 98us)
  3429     0791  0821               	movf	33,w	;4
  3430     0792  00A0               	movwf	32	;1
  3431     0793  0BA2               	decfsz	34,f	;2
  3432     0794  2F8E               	goto	DELAY_LOOP_1	;3,4
  3433     0795  0008               	return
  3434     0796                     DELAY_600us:	
  3435                           ;==========================================
  3436                           
  3437     0796  279B               	call	DELAY_100us
  3438     0797                     DELAY_500us:
  3439     0797  279B               	call	DELAY_100us
  3440     0798                     DELAY_400us:
  3441     0798  279B               	call	DELAY_100us
  3442     0799                     DELAY_300us:
  3443     0799  279B               	call	DELAY_100us
  3444     079A                     DELAY_200us:
  3445     079A  279B               	call	DELAY_100us
  3446     079B                     DELAY_100us:
  3447     079B  27A4               	call	DELAY_10us
  3448     079C                     DELAY_90us:
  3449     079C  27A4               	call	DELAY_10us
  3450     079D  27A4               	call	DELAY_10us
  3451     079E  27A4               	call	DELAY_10us
  3452     079F                     DELAY_60us:
  3453     079F  27A4               	call	DELAY_10us
  3454     07A0                     DELAY_50us:
  3455     07A0  27A4               	call	DELAY_10us
  3456     07A1                     DELAY_40us:
  3457     07A1  27A4               	call	DELAY_10us
  3458     07A2                     DELAY_30us:
  3459     07A2  27A4               	call	DELAY_10us
  3460     07A3                     DELAY_20us:
  3461     07A3  27A4               	call	DELAY_10us
  3462     07A4                     DELAY_10us:
  3463     07A4  0000               	nop
  3464     07A5  0000               	nop
  3465     07A6                     DELAY_9us:
  3466     07A6  0000               	nop
  3467     07A7  0000               	nop
  3468     07A8                     DELAY_8us:
  3469     07A8  0000               	nop
  3470     07A9  0000               	nop
  3471     07AA                     DELAY_7us:
  3472     07AA  0000               	nop
  3473     07AB  0000               	nop
  3474     07AC                     DELAY_6us:
  3475     07AC  0000               	nop
  3476     07AD  0000               	nop
  3477     07AE                     DELAY_5us:
  3478     07AE  0000               	nop
  3479     07AF  0000               	nop
  3480     07B0                     DELAY_4us:
  3481     07B0  0000               	nop
  3482     07B1  0000               	nop
  3483     07B2                     DELAY_3us:
  3484     07B2  0000               	nop
  3485     07B3  0000               	nop
  3486     07B4                     DELAY_2us:
  3487     07B4  0008               	return
  3488                           
  3489                           	psect	config
  3490                           
  3491                           ;Config register CONFIG1 @ 0x8007
  3492                           ;	Oscillator Selection
  3493                           ;	FOSC = INTOSC, INTOSC oscillator: I/O function on CLKIN pin
  3494                           ;	Watchdog Timer Enable
  3495                           ;	WDTE = OFF, WDT disabled
  3496                           ;	Power-up Timer Enable
  3497                           ;	PWRTE = OFF, PWRT disabled
  3498                           ;	MCLR Pin Function Select
  3499                           ;	MCLRE = OFF, MCLR/VPP pin function is digital input
  3500                           ;	Flash Program Memory Code Protection
  3501                           ;	CP = OFF, Program memory code protection is disabled
  3502                           ;	Data Memory Code Protection
  3503                           ;	CPD = OFF, Data memory code protection is disabled
  3504                           ;	Brown-out Reset Enable
  3505                           ;	BOREN = OFF, Brown-out Reset disabled
  3506                           ;	Clock Out Enable
  3507                           ;	CLKOUTEN = OFF, CLKOUT function is disabled. I/O or oscillator function on the CLKOUT pin
  3508                           ;	Internal/External Switchover
  3509                           ;	IESO = OFF, Internal/External Switchover mode is disabled
  3510                           ;	Fail-Safe Clock Monitor Enable
  3511                           ;	FCMEN = OFF, Fail-Safe Clock Monitor is disabled
  3512     8007                     	org	32775
  3513     8007  09A4               	dw	2468
  3514                           
  3515                           ;Config register CONFIG2 @ 0x8008
  3516                           ;	Flash Memory Self-Write Protection
  3517                           ;	WRT = OFF, Write protection off
  3518                           ;	Voltage Regulator Capacitor Enable
  3519                           ;	VCAPEN = OFF, VCAP pin functionality is disabled
  3520                           ;	PLL Enable
  3521                           ;	PLLEN = OFF, 4x PLL disabled
  3522                           ;	Stack Overflow/Underflow Reset Enable
  3523                           ;	STVREN = OFF, Stack Overflow or Underflow will not cause a Reset
  3524                           ;	Brown-out Reset Voltage Selection
  3525                           ;	BORV = HI, Brown-out Reset Voltage (Vbor), high trip point selected.
  3526                           ;	Low-Voltage Programming Enable
  3527                           ;	LVP = OFF, High-voltage on MCLR/VPP must be used for programming
  3528     8008                     	org	32776
  3529     8008  18FF               	dw	6399


Microchip Technology PIC Macro Assembler V2.40 build 20220703182018 
Symbol Table                                                                                               Mon Oct 02 16:38:53 2023

                            C 0000               CRC_COUNTER_TEMP 0026                              Z 0002  
                           RD 0000                             WR 0001                            GIE 0007  
                          PR2 001B                            PR4 0416              MODBUS_ERROR_FLAG 003B  
                         CFGS 0006                           CREN 0004                           LATA 010C  
                         LATB 010D                           LATC 010E                           LATD 010F  
                         LATE 0110                           LATF 038C                           LATG 038D  
                         PIE1 0091                           PIE2 0092                           PIE3 0093  
                         PIE4 0094                           INTE 0004                           INTF 0001  
                         PIR1 0011                           PIR4 0014                           M_OE 0004  
                         TRMT 0001                           WREN 0002              STRONG_STOP_TEMP1 0042  
            STRONG_STOP_TEMP2 0043            CRC_16_END_FUNCTION 0720                          AAAAN 0724  
          TEST_FUNCTION_LOOP1 039E            TEST_FUNCTION_LOOP2 03A5                          BANK7 038C  
                        EEPGD 0007                          M1_FR 0001                          M2_FR 0003  
                        T2CON 001C                          INDF0 0000                          INDF1 0001  
                        M1_ST 0000                          M2_ST 0002                          RC2IE 0005  
                        RC2IF 0005                          T4CON 0417                          IOCBF 0396  
                        IOCBN 0395                          IOCBP 0394                          FSR0H 0005  
                        FSR1H 0007                          IOCIE 0003                          IOCIF 0000  
                        FSR0L 0004                          FSR1L 0006                          PORTA 000C  
                        PORTB 000D                          PORTC 000E                          PORTD 000F  
                        PORTE 0010                          PORTF 028C                          PORTG 028D  
                        TRISA 008C                          TRISB 008D                          TRISC 008E  
                        TRISD 008F                          TRISE 0090                          TRISF 030C  
                        TRISG 030D                          M_RST 0005      MODBUS_ERROR_CODE_01_LOOP 0494  
    MODBUS_ERROR_CODE_02_LOOP 04A8      MODBUS_ERROR_CODE_03_LOOP 04B6      MODBUS_ERROR_CODE_04_LOOP 04C4  
    MODBUS_ERROR_CODE_05_LOOP 04D2      MODBUS_ERROR_CODE_06_LOOP 04E0           CHECK_CRC16_IS_RIGHT 00D8  
                       ADCON0 009D                         ADCON1 009E                         ADRESH 009C  
                       ADRESL 009B                         EEADRL 0191                         EEDATL 0193  
                       CCPR3L 0311                         EECON1 0195                         EECON2 0196  
                       ANSELA 018C                         ANSELE 0190                         ANSELF 040C  
                       ANSELG 040D                         RC2STA 0495                         PCLATH 000A  
                       INTCON 000B            MOTOR_1_WORK_CW_LV1 0538            MOTOR_1_WORK_CW_LV2 0559  
          MOTOR_1_WORK_CW_LV3 0544            MOTOR_1_WORK_CW_LV4 0547            MOTOR_1_WORK_CW_LV5 057C  
                       OSCCON 0099                         TMR2IE 0001                         TMR2IF 0001  
                       TMR2ON 0002                         TX2REG 0492                         TX2STA 0496  
                       STATUS 0003           TMR2IF_FUNCTION_LOOP 001E               RTU_COUNTER_DATA 002A  
            MOTOR_OE_RST_PORT 010C           MOTOR_1_WORKING_LOOP 04F1               SYSTEM_START_LV1 03AA  
         MODBUS_ERROR_COUNTER 0049                PWM_1_COUNT_DAT 0040                        CCP3CON 0313  
          MOTOR_2_WORK_CW_LV1 0639            MOTOR_2_WORK_CW_LV2 065A           MOTOR_1_WORK_CCW_LV1 05A1  
         MOTOR_1_WORK_CCW_LV2 05C5           MOTOR_1_WORK_CCW_LV3 05AF           MOTOR_1_WORK_CCW_LV4 05B2  
         MOTOR_1_WORK_CCW_LV5 05E9                PWM_2_COUNT_DAT 0041           MOTOR_1_WORK_CW_LOOP 0521  
                      OSCSTAT 009A                        TP0_PIN 0000                        OSCTUNE 0098  
         STRONG_STOP_FUNCTION 029F            CRC_16_FUNCTION_LV1 0712         MOTOR_2_WORK_CW_FINISH 064C  
                   DELAY_10ms 0783                     DELAY_20ms 0782                     DELAY_10us 07A4  
                   DELAY_20us 07A3                     DELAY_40ms 0781                     DELAY_30us 07A2  
                   DELAY_40us 07A1                     DELAY_50us 07A0                     DELAY_60us 079F  
                   DELAY_90us 079C            MOTOR1_IN_ROAT_FLAG 0001           TEN_MS_FUNCTION_LOOP 0058  
             NOW_MOTOR_1_FLAG 0000               NOW_MOTOR_2_FLAG 0001               NOW_MOTOR_3_FLAG 0002  
       WAIT_EEPROM_WRITE_OVER 0771               NOW_MOTOR_4_FLAG 0003               CAN_SEND_TX_FLAG 0000  
      MOTOR_1_WORK_CCW_FINISH 05C0          ROAT_MOTOR_IS_HI_FLAG 0003          MODBUS_DAT_EXTRA_ADRH 0020  
        MODBUS_DAT_EXTRA_ADRL 00B0             INTERRUPT_SUB_AREA 0006      STRONG_RESET_MOTOR_1_FUNC 0278  
    STRONG_RESET_MOTOR_2_FUNC 027D                     M1_ENCODER 0001          MOTOR_1_ZERO_FUNCTION 044B  
       SET_MODBUS_MODE_ENABLE 0D08         MODBUS_ADR_00_FUNCTION 001A                     EEPROM_ADR 007E  
          MOTOR1_IN_ZERO_FLAG 0000                     EEPROM_DAT 007F                     M2_ENCODER 0002  
          M1_NOT_COUNTER_TEMP 0053         MODBUS_ADR_01_FUNCTION 001A         MOTOR1_ZERO_IN_HI_LOOP 042D  
       MODBUS_ADR_02_FUNCTION 001A            RECOVER_MODULE_LOOP 026A                     CRC_HIBYTE 0028  
          RC2IF_FUNCTION_LOOP 001A                  ADDR_4_5_PORT 000C                     CRC_LOBYTE 0029  
       MOTOR1_ZERO_IN_LO_LOOP 0403                  ADDR_6_7_PORT 000D         MODBUS_ADR_03_FUNCTION 001A  
          IOCBF2_INT_LOOP_LV1 006C         MODBUS_ADR_04_FUNCTION 001A           MOTOR_2_WORKING_LOOP 05F5  
        MODBUS_ERROR_CODE_END 04A1              INT_INTF_FUNCTION 0087                     ERROR_01_F 0000  
                   ERROR_02_F 0001                     ERROR_03_F 0002                     ERROR_04_F 0003  
                   ERROR_05_F 0004                     ERROR_06_F 0005     MOTOR1_ZERO_IN_HI_LOOP_LV1 043F  
     MODBUS_RTU_READ_CRC_LOOP 02EB          MOTOR1_TIME_ZERO_LOOP 0442             WATCH_SUB_FUNCTION 06F0  
      MOTOR_2_WORK_CCW_FINISH 0697             WATCH_SUB_FUNC_LV1 06F8           MOTOR_2_WORK_CCW_LV1 0684  
         MOTOR_2_WORK_CCW_LV2 069C                       ADDSEL_4 0006                       ADDSEL_5 0007  
                     ADDSEL_6 0007                       ADDSEL_7 0006                       ADC_WORK 06E7  
       MODBUS_INTPUT_FUNCTION 0D1F           MOTOR_2_WORK_CW_LOOP 0629                       CCPTMRS0 029E  
                     CCPTMRS1 029F          MOTOR_1_WORK_CCW_LOOP 058B                   MOTOR1_FLAG0 0072  
                 MOTOR1_FLAG1 0035                BOOTLOADER_LOOP 0005                   MOTOR2_FLAG0 0032  
                 MOTOR2_FLAG1 0036                    ADC_HI_DATA 007C               MODULE_WORK_LOOP 04EE  
          MOTOR2_IN_ROAT_FLAG 0001                 ID_SELECT_LOOP 0367           ANAY_MODBUS_READ_LV0 016A  
                   MOTOR_1_CW 0002                     MOTOR_2_CW 0002              CCW_STEP_FUNCTION 028F  
         CRC_16_FUNCTION_LOOP 070D                   MOTOR_1_WORK 0001                   MOTOR_2_STOP 03D1  
                 MOTOR_2_WORK 0001             CLEAN_ALL_REGISTER 0743                     WATCH_TEMP 0072  
                   OPTION_REG 0095            MOTOR2_IN_ZERO_FLAG 0000               MOTOR_1_ING_ZERO 0005  
                   TEN_MS_NUM 0002               MOTOR_2_ING_ZERO 0005                 TIMER2_INT_LV1 0042  
                  DELAY_100ms 077F                    DELAY_100us 079B                    DELAY_200us 079A  
                  DELAY_300us 0799                    DELAY_400us 0798                    DELAY_500ms 077B  
                  DELAY_500us 0797                    DELAY_600us 0796          MOTOR_1_CW_IOC_SET_HI 0570  
                  DELAY_TEMP1 0020                    DELAY_TEMP2 0021                    DELAY_TEMP3 0022  
   MOTOR1_ZERO_IN_LO_LOOP_LV1 0415                    FLAG1_BANK0 0030         READ_MOTOR_1_SOME_DATA 0190  
                  FLAG2_BANK0 0039                     PWR_DECTET 0005                    FLAG3_BANK0 003A  
                  FLAG5_BANK0 003C             MOTOR_1_IOC_FINISH 0007                  MODULE_ID_DAT 0025  
       READ_MOTOR_2_SOME_DATA 0195                  CAL_DATA_TEMP 0027             SET_TMR2_BASE_TIME 0732  
       READ_MOTOR_3_SOME_DATA 019C          MODBUS_TABLE_ADR_TEMP 004A      POWER_LED_OUTPUT_FUNCTION 0371  
              SET_TMR2_INT_EN 073B         READ_MOTOR_4_SOME_DATA 01A3              COMMON_DATA_HBYTE 0022  
            COMMON_DATA_LBYTE 0030         MOTOR_1_CCW_IOC_SET_HI 05DD                 IOC_HW_SETTING 0362  
     MODBUS_BUS_01_ERROR_LOOP 00BF                    MAX485_PORT 038D               MODBUS_DAT_COUNT 002F  
                INT_TIMER_NUM 0004          MOTOR_2_ZERO_FUNCTION 0478          M1_ZERO_COUNTER_HBYTE 0050  
        M1_ZERO_COUNTER_LBYTE 0051        ANAY_MODBUS_CMD_03_LOOP 00F3        ANAY_MODBUS_CMD_06_EXIT 0215  
      ANAY_MODBUS_CMD_06_LOOP 01BD            STORE_WRITE_ACK_LV1 01B6       MODBUS_BUS_02_ERROR_LOOP 00C1  
             TMR2_DIVIDER_SET 0015         CHECK_MOTOR2_ZERO_LOOP 03DC             TEST_FUNCTION_LOOP 039A  
     MODBUS_BUS_03_ERROR_LOOP 00C3          MOTOR_2_IOC_STOP_LOOP 0617            TMR2IF_FUNCTION_LV0 0025  
              CHECK_IOC_IS_HI 0572                CHECK_IOC_IS_LO 0581           RESET_IN_NORMAL_FALG 0000  
                    AAAA_1800 0722            WRITE_EEPROM_LOOP_1 0769         ADC_TAKE_DATA_FUNCTION 06DA  
     MODBUS_BUS_04_ERROR_LOOP 00C5                  CAN_WORK_FLAG 0001                    READ_EEPROM 0759  
       STRONG_CW_MOTOR_1_FUNC 0284                IOCBF1_INT_LOOP 0066         STRONG_CW_MOTOR_2_FUNC 028C  
        MOTOR_2_WORK_CCW_LOOP 0674                  ADR_TEST_TEMP 002E                IOCBF2_INT_EXIT 0072  
              IOCBF2_INT_LOOP 0069             WATCH_DAT_BUF_ADRH 0020             WATCH_DAT_BUF_ADRL 00BA  
                    DELAY_1ms 0788                      DELAY_2ms 0787                      DELAY_3ms 0786  
                    DELAY_4ms 0785                      DELAY_5ms 0784                      DELAY_2us 07B4  
                    DELAY_3us 07B2                      DELAY_4us 07B0                      DELAY_5us 07AE  
                    DELAY_6us 07AC                      DELAY_7us 07AA                      DELAY_8us 07A8  
                    DELAY_9us 07A6      ANAY_MODBUS_READ_0X80_LV1 017F       MODBUS_BUS_05_ERROR_LOOP 00C7  
         MODBUS_DAT_REAL_ADRH 0021           MODBUS_DAT_REAL_ADRL 0040                 TMR2_BASE_TEMP 0023  
          MODBUS_RTU_READ_LV2 02E0              TEST_MAX485_LOOP1 06C3              IOC_ROCK_FUNCTION 0084  
  ANAY_MODBUS_WRITE_0X80_LOOP 021A                 ADC_HW_SETTING 0347                   WRITE_EEPROM 0763  
     MODBUS_BUS_06_ERROR_LOOP 00C9         MOTOR_1_WORK_CW_FINISH 0554                   ADC_LOW_DATA 007D  
        TEST_MAX485_LOOP1_LV1 06CD                    MOTOR_1_CCW 0003                    MOTOR_2_CCW 0003  
             IOC_INT_FUNCTION 005F                  MOTOR_1_RESET 0004                  MOTOR_2_RESET 0004  
                MOTOR_2_WORK1 03C6                MOTOR_1_HI_ZERO 0006                      TEST_PORT 038C  
         COMMON_CMD_0X83_LOOP 0222                    WATCH_OUT_P 0110                   SYSTEM_START 03A9  
          NOW_IS_LO_HI_STATUS 0000                    TEN_TIME_EN 0001                   ADR_80_H_DAT 00A0  
                  TEN_MS_TEMP 0048                   ADR_81_H_DAT 00A2                   ADR_80_L_DAT 00A1  
                 ADR_82_H_DAT 00A4                   ADR_81_L_DAT 00A3                   ADR_83_H_DAT 00A6  
                 ADR_82_L_DAT 00A5        CHECK_PWM_FREQ_FUCNTION 0367                   ADR_83_L_DAT 00A7  
        POWER_LED_OUTPUT_EXIT 0376                    SET_TMR2_ON 073F            MODBUS_ADR_FUNCTION 0011  
                 DELAY_1000ms 077A                   DELAY_3000ms 0778        STRONG_CCW_MOTOR_1_FUNC 0294  
      STRONG_CCW_MOTOR_2_FUNC 029C        RECOVER_MODULE_LOOP_LV1 022C                  WATCH_COUNTER 0070  
             POWER_CHECK_PORT 000D              MOTOR_1_NOW_IS_HI 046E              MOTOR_1_NOW_IS_LO 0464  
MODBUS_TIMEOUT_IS_FINISH_LOOP 008D               CW_STEP_FUNCTION 027F                  WATCH_OUT_DAT 0005  
                WATCH_OUT_CLK 0006                   DELAY_LOOP_1 078E                 IOCB2_HI_TO_LO 0074  
   ANAY_MODBUS_READ_0X80_LOOP 015E                 IOCB2_LO_TO_HI 007C     ANAY_MODBUS_READ_0X90_LOOP 0153  
     MODBUS_CRC16_CHECK_IS_OK 00A7            RESET_STEP_FUNCTION 0273               CHECKC_IOC_IS_HI 05DF  
             CHECKC_IOC_IS_LO 05EB           PREPARE_TX_DATA_LOOP 06B7       MODBUS_BUS_ID_ERROR_LOOP 00CB  
                TMR2_BASE_SET 00A7                  TMR2_BASE_NUM 0004             MOTOR_CONTROL_PORT 010E  
          SETTING_PWM_HW_LOOP 0351                TX_DATA_COUNTER 002D       CHECK_CRC16_IS_RIGHT_LV1 00E3  
                MAX485_SELECT 0003              IOC_COUNTER_HBYTE 0046              IOC_COUNTER_LBYTE 0047  
      CLEAN_ALL_REGISTER_LOOP 074B        MODBUS_BUS_ID_ERROR_LV1 00D1       RESET_END_IN_NORMAL_LOOP 050F  
      WRITE_MOTOR_1_SOME_DATA 02C2       STRONG_STOP_MOTOR_1_FUNC 02A4       STRONG_STOP_MOTOR_2_FUNC 02B2  
      WRITE_MOTOR_2_SOME_DATA 02C8               ACK_COUNTER_TEMP 0074        WRITE_MOTOR_3_SOME_DATA 02D0  
          ALL_MOTOR_STOP_FLAG 0004  RESET_MODBUS_TIMEOUT_FUNCTION 003E           SYSTEM_START_SETTING 02F7  
              WATCH_BIT_COUNT 0071        WRITE_MOTOR_4_SOME_DATA 02D8      ANAY_MODBUS_CMD_03_LEVEL1 012D  
    ANAY_MODBUS_CMD_03_LEVEL2 0142                 INT_TIMER_TEMP 0024                 INT_HW_SETTING 0377  
    ANAY_MODBUS_CMD_06_LEVEL1 01EC                TMR2IF_FUNC_LV1 002B             INT_TRIG_TIME_FLAG 0004  
         STORE_WRITE_ACK_LOOP 01AA                 CAL_TEMP_HBYTE 002B                 CAL_TEMP_LBYTE 002C  
